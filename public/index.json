[{"authors":null,"categories":null,"content":"Eu, Rafael de Acypreste, sou doutor em Economia pela Universidade de Brasília, orientado pela professora Maria de Lourdes Rollemberg Mollo. Tenho pesquisado as relações entre automação e emprego. Venho me aprofundando em trabalhos ligados à Matriz de Insumo-Produto. Também tenho interesse na elaboração de materiais didáticos relacionados ao uso do R.\n  Acesse meu Currículo Lattes.\n","date":-62135596800,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":-62135596800,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/author/rafael-de-acypreste/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/rafael-de-acypreste/","section":"authors","summary":"Eu, Rafael de Acypreste, sou doutor em Economia pela Universidade de Brasília, orientado pela professora Maria de Lourdes Rollemberg Mollo. Tenho pesquisado as relações entre automação e emprego. Venho me aprofundando em trabalhos ligados à Matriz de Insumo-Produto.","tags":null,"title":"Rafael de Acypreste","type":"authors"},{"authors":null,"categories":null,"content":"吳恩達 is a professor of artificial intelligence at the Stanford AI Lab. His research interests include distributed robotics, mobile computing and programmable matter. He leads the Robotic Neurobiology group, which develops self-reconfiguring robots, systems of self-organizing robots, and mobile sensor networks.\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Sed neque elit, tristique placerat feugiat ac, facilisis vitae arcu. Proin eget egestas augue. Praesent ut sem nec arcu pellentesque aliquet. Duis dapibus diam vel metus tempus vulputate.\n","date":-62135596800,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":-62135596800,"objectID":"e87efdfe209d90ea3c6332a7cbd9d08b","permalink":"/author/%E5%90%B3%E6%81%A9%E9%81%94/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/%E5%90%B3%E6%81%A9%E9%81%94/","section":"authors","summary":"吳恩達 is a professor of artificial intelligence at the Stanford AI Lab. His research interests include distributed robotics, mobile computing and programmable matter. He leads the Robotic Neurobiology group, which develops self-reconfiguring robots, systems of self-organizing robots, and mobile sensor networks.","tags":null,"title":"吳恩達","type":"authors"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Wowchemy\u0026rsquo;s Slides feature and link using slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further event details, including page elements such as image galleries, can be added to the body of this page.\n","date":1906549200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1906549200,"objectID":"a8edef490afe42206247b6ac05657af0","permalink":"/talk/example-talk/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/example-talk/","section":"event","summary":"An example talk using Wowchemy's Markdown slides feature.","tags":[],"title":"Example Talk","type":"event"},{"authors":["Ricardo Araujo","Theo Santini","Rafael de Acypreste"],"categories":null,"content":"","date":1639612800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1639612800,"objectID":"e54f5c80c4df76de54b454fa8137a5ec","permalink":"/publication/vis-ssrn-2021/","publishdate":"2021-12-16T00:00:00Z","relpermalink":"/publication/vis-ssrn-2021/","section":"publication","summary":"Focusing on the interindustry aspect of the structural economic dynamics (SED) to yield a non-autarchic perspective to the vertically integrated sectors (VIS), we go a step further in establishing that productivity growth at the industry level is transmitted via inter and intra-sectoral pecuniary spillovers. To accomplish this task, we deal with technical aspects of shifting from inter-industry to vertically integrated analysis. Besides, dimensions of the Kaldor-Verdoorn (KV) law are selectively embedded in Pasinetti’s multisectoral model, thus rendering technical change endogenous. With this approach, we take into account both external and internal economies of scale, allowing us to formally reconcile the KV and Smith-Young (SY) views on cumulative causation and increasing returns. We highlight that the interdependent nature of the VIS impacts the capability of spreading pecuniary externalities throughout the economy.","tags":null,"title":"A Vertically Integrated Approach to Increasing Returns and Cumulative Causation","type":"publication"},{"authors":["Rafael de Acypreste","Maria de Lourdes R. Mollo"],"categories":null,"content":"","date":1638835200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1638835200,"objectID":"1b56dece1347427e8bb94848f42bb864","permalink":"/publication/nova-economia-2021/","publishdate":"2021-12-07T00:00:00Z","relpermalink":"/publication/nova-economia-2021/","section":"publication","summary":"Este artigo busca refletir acerca dos impactos das inovações tecnológicas sobre o emprego, a partir de três autores de concepções teóricas distintas, quais sejam, Ricardo, Marx e Wicksell. Em particular, procura-se recuperar os argumentos utilizados em três importantes abordagens do problema: a da compensação; a da tendência intrínseca de geração de desemprego tecnológico, sujeito a contratendências; e a de equilíbrio ótimo, com maximização do produto e aumento de salários. Após a análise dos debates, o artigo mostra como várias das questões neles presentes permanecem ainda nas discussões atuais, destacando seu caráter inconcluso.","tags":null,"title":"A questão da maquinaria em Ricardo, Marx e Wicksell","type":"publication"},{"authors":[],"categories":[],"content":"","date":1630707021,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1630707021,"objectID":"5b9edaa1eb254cd480956f2b5b5743e2","permalink":"/post/2021-09-03-manipulacao-de-tabelas-elaboracao-de-graficos-e-2a-lista-de-exercicios/","publishdate":"2021-09-03T19:10:21-03:00","relpermalink":"/post/2021-09-03-manipulacao-de-tabelas-elaboracao-de-graficos-e-2a-lista-de-exercicios/","section":"post","summary":"","tags":[],"title":"2021 09 03 Manipulação De Tabelas Elaboração De Gráficos E 2a Lista De Exercícios","type":"post"},{"authors":[],"categories":[],"content":"\r\r\r\rIntrodução\r1 Manipulação e exportação de dados\r\r1.1 Apresentação típica\r1.2 Transposta da apresentação típica\r1.3 Tidy data\r1.4 Resumo para dados organizados\r\r2 Elaboração de gráficos\r3 Compontentes básicos dos gráficos\r\r3.1 Mapeamentos estéticos (variáveis)\r3.2 Geometrias (geoms)\r3.3 Eixos e escalas\r3.4 Temas\r3.5 Séries de tempo e casos mais avançados\r\r4 Exercícios parte II\r\r4.1 Manipulação de dados\r4.2 Exportação de dados\r4.3 Elaboração de gráficos\r\rReferências\r\r\rIntrodução\rEsta nota tem por objetivo exercitar o ferramental básico para manipular tabelas e elaborar gráficos para uma análise exploratória dos dados. São duas ações que devem caminhar juntas, especialmente porque dados efetivamente organizadas tornam a elaboração de gráficos um procedimento mais direto e simples.\nVale lembrar que tabelas devem ser sucintas e gráficos devem contar uma história da maneira mais simples possível. Portanto, a preocupação não deve ser com uma completude, certamente inalcançável.\nSuas tabelas, gráficos e textos terão atingido a melhor versão quando não há mais nada que lhes possa ser retirado.\n\r1 Manipulação e exportação de dados\rNem sempre os dados importados ao R vêm no formato ideal. Enquanto os pacotes sidrar e wid fornecem tabelas no formato convencionalmente denominado de tidy data1 (Wickham 2014), outras fontes de dados ou tabelas baixadas manualmente costumam não apresentar a devida consistência.\nEm síntese, cada valor (cada célula numa tabela do Excel, por exemplo) pertence a uma variável  e a uma observação.\nVariável contém valores que se referem a uma mesma característica ou atributo — em dados sobre mercado de trabalho, pode-se citar como exemplos região, data, taxa de desocupação. Nesse caso, cada variável deve ser representada por uma única coluna.\nCada observação (linha) contém todos os valores medidos sobre uma mesma unidade, configurando um único item entre os atributos (ou colunas) — um exemplo poderia ser a taxa de desocupação no Centro-Oeste no 1o trimestre de 2020.\nOs erros mais comuns são aqueles em que uma variável está espalhada em várias colunas. Ajustar esses dados passa a ser o primeiro passo para a análise exploratória.\n1.1 Apresentação típica\rUma forma de apresentação típica de dados econômicos, mas que não estão no formato ideal é representada por\n\r\rGrande Região\r\r1º trimestre 2016\r\r1º trimestre 2020\r\r\r\r\r\rNordeste\r\r12.8\r\r15.6\r\r\r\rSul\r\r7.3\r\r7.5\r\r\r\rCentro-Oeste\r\r9.7\r\r10.6\r\r\r\r\r\rNote:   Taxa de Desocupação (PNADC/T - IBGE)\r\r\r\r\rem que se pode notar que há três variáveis (região, período e taxa de desocupação), mas que não estão divididos em colunas separadas.\nNo exemplo, o período deve constituir uma variável e, portanto, uma coluna. Entretanto, os dados para o período são utilizados erroneamente como nomes de colunas.\n\r1.2 Transposta da apresentação típica\rNão é incomum utilizar-se a versão transposta da tabela apresentada acima.\n\r\rTrimestre\r\rNordeste\r\rSul\r\rCentro-Oeste\r\r\r\r\r\r1º trimestre 2016\r\r12.8\r\r7.3\r\r9.7\r\r\r\r1º trimestre 2020\r\r15.6\r\r7.5\r\r10.6\r\r\r\r\r\rNote:   Taxa de Desocupação (PNADC/T - IBGE)\r\r\r\r\rNesse caso, as regiões estão erroneamente utilizadas como nomes das colunas.\n\r1.3 Tidy data\rO formato mais adequado para organização dos dados e elaboração de gráficos também é conhecido como formato longer, em que se pode usar a função pivot_longer do pacote tidyverse. Para os dados apresentados acima, a organização é dada por\n\r\rTrimestre\r\rGrande Região\r\rDesocupação (%)\r\r\r\r\r\r1º trimestre 2016\r\rNordeste\r\r12.8\r\r\r\r1º trimestre 2016\r\rSul\r\r7.3\r\r\r\r1º trimestre 2016\r\rCentro-Oeste\r\r9.7\r\r\r\r1º trimestre 2020\r\rNordeste\r\r15.6\r\r\r\r1º trimestre 2020\r\rSul\r\r7.5\r\r\r\r1º trimestre 2020\r\rCentro-Oeste\r\r10.6\r\r\r\r\r\rNote:   Taxa de Desocupação (PNADC/T - IBGE)\r\r\r\r\rMesmo que pareça estranho, há duas boas razões para organizar os dados assim:\nPode-se descrever relações funcionais entre variáveis.\n\rEx.: evolução da taxa de desocupação no tempo.\rMelhor fazer entre colunas.\r\rPode-se fazer comparações entre grupos de observações:\n\rEx.: como está o desemprego entre regiões?\rMelhor fazer entre linhas.\r\r\r\r1.4 Resumo para dados organizados\rPara dados organizados, vale a seguinte regra de bolso:\nCada variável forma uma coluna;\n\rCada observação forma uma linha; e\n\rCada unidade observacional forma uma tabela.\n\r\rSe quiser mais detalhes sobre o tema, é interessante consultar Wickham (2014). Com os dados organizados, pode-se elaborar tabelas e gráficos de maneira correta e mais intuitiva.\n\r\r2 Elaboração de gráficos\rApresentar informações estatísticas por meio de gráficos pode ser uma ferramenta importante para melhorar o entendimento de informações complexas. Para isso, deve-se elaborar um gráfico eficiente.\nUm gráfico é mais eficiente que o outro se sua informação pode ser decodificada pela maioria dos leitores de forma mais rápida ou mais fácil de acordo com Robbins (2004).\nPortanto, cuidados são necessários para que os gráficos não sejam ineficientes, confusos ou transmitam informações erradas. De maneira sintética, os gráficos podem seguir as seguintes diretrizes:\nChamar a atenção para o que é importante nos seus dados (as pessoas procuram os destaques e diferenças em primeiro lugar);\rSimplificar e reduzir as informações periféricas; e\rIdentificar as hierarquias dos dados e refleti-las nos gráficos.\r\rTodos esses passos devem ser disponibilizados ao público leitor demandando o mínimo de esforço para decodificação. Por isso, é também importante usar a linguagem mais simples possível.\nPortanto, de maneira geral, busca-se remover informações redundantes, como cores, textos, elementos decorativos e etc. que não dizem respeito diretamente às suas informações. Em resumo, use o mínimo de tinta.\nFeitas essas considerações inciais, seguem algumas rotinas realizadas para a apresentação de dados estatísticos econômicos com o pacote ggplot2.\nEsse pacote permite apresentar dados seguindo uma “gramática de gráficos” , que “makes ggplot2 very powerful because you are not limited to a set of pre-specified graphics, but you can create new graphics that are precisely tailored for your problem” (Wickham 2015).\nEm síntese, Wickham (2015) explica essa gramática de gráficos como uma representação estatística que mapeia informações em atributos estéticos (cores, formatos, tamanhos) de objetos geométricos (pontos, linhas, barras) em um sistema específico de coordenadas.\nDiferentes facetas podem ser usadas para representar, numa única imagem, diferentes subconjuntos de uma tabela. E é a combinação desses elementos que forma um gráfico.\nDo ponto de vista mais concreto, em primeiro lugar, é necessário instalar (uma única vez) e carregar os pacotes abaixo para realizar as rotinas no R2.\n# install.packages(\u0026quot;tidyverse\u0026quot;) Instala o pacote tidyverse, por exemplo\rlibrary(tidyverse) # Organização das tabelas e elaboração de gráficos\rlibrary(RColorBrewer) # Paletas de cores para os gráficos\rlibrary(viridis) # Paletas de cores para os gráficos\rlibrary(ggthemes) # Interfaces gráficas adicionais\rlibrary(scales) # Ajuste de escala dos gráficos\rlibrary(lubridate) # Ferramenta para ajuste de datas\rlibrary(zoo) # Ferramenta também para ajuste de datas\rlibrary(sidrar) # Acessar dados do IBGE\roptions(scipen = 999)\rPor fim, lembre-se de que um bom processo de elaboração de gráficos exige que sua matéria prima esteja no formato ideal, com as tabelas devidamente organizadas.\n\r3 Compontentes básicos dos gráficos\rTodos os gráficos feitos com o ggplot2 têm seis componentes básicos:\nInformações (tabela);\rMapeamentos estéticos (variáveis e outras propriedades visuais);\rCamadas (formato que as informações serão apresentadas, transformações estatísticas e ajustes de posicionamentos);\rEscalas para cada mapeamento estético (guias para ler os valores, normalmente explicados nas legendas);\rSistema de coordenadas; e\rEspecificação de facetas ou subconjuntos.\r\rOs três primeiros elementos são normalmente suficientes para análises exploratórias dos dados, em que o objetivo é conhecer melhor os dados que foram coletados. Tratam-se de gráficos usados apenas pelo(a) pesquisador(a) e, em geral, são insuficientes para apresentação dos resultados.\nPara fins desta nota, serão utilizados em quase todos os gráficos as informações relativas à taxa de desocupação da força de trabalho (Tabela 6397), ao rendimento médio real (Tabela 5437) e à média de horas habitualmente trabalhadas por semana (Tabela 6372) por grupos de idade entre o 1o trimestre de 2016 e o 1o trimestre de 2020. Todas as informações foram coletadas na Pesquisa Nacional por Amostra de Domicílios Contínua Trimestral (PNADC/T), realizada pelo IBGE.\nOs dados são baixados por meio do pacote sidrar. Nesse caso, as tabelas são baixadas individualmente e, ao final, juntadas pelas categorias em comum. As informações para identificar os elementos das tabelas que queremos podem ser acessadas pela função info_sidra().\n## Tabela 6397 - Taxas de desocupação e de subutilização da força de trabalho,\r## na semana de referência, das pessoas de 14 anos ou mais de idade,\r## por grupos de idade\r# info_sidra(6397,wb = T)\rdesocupacao \u0026lt;- get_sidra(\r6397,\rperiod = \u0026quot;201601-202001\u0026quot;, # Seleciona trimestres\rgeo = \u0026quot;Region\u0026quot;, # 5 Regiões Brasileiras\rvariable = c(4099),\rformat = 2\r)\rtabela1 \u0026lt;- desocupacao %\u0026gt;%\rrename(\u0026quot;Desocupacao\u0026quot; = Valor) %\u0026gt;% # Renomeia a variável de interesse\rselect(`Grande Região`, Trimestre, `Grupo de idade`, Desocupacao)\rhead(tabela1, n = 3) # Mostra as três primeiras linhas\r## Grande Região Trimestre Grupo de idade Desocupacao\r## 2 Norte 1º trimestre 2016 Total 10.5\r## 3 Norte 1º trimestre 2016 14 a 17 anos 24.4\r## 4 Norte 1º trimestre 2016 18 a 24 anos 23.2\r## Tabela 5437 - Rendimento médio real, habitualmente recebido por mês e\r## efetivamente recebido no mês de referência, do trabalho principal e\r## de todos os trabalhos, por grupos de idade # info_sidra(5437,wb = T)\rrendimento \u0026lt;- get_sidra(\r5437,\rperiod = \u0026quot;201601-202001\u0026quot;,\rgeo = \u0026quot;Region\u0026quot;,\rvariable = c(5932),\rformat = 2\r)\rtabela2 \u0026lt;- rendimento %\u0026gt;%\rrename(\u0026quot;Rendimento\u0026quot; = Valor) %\u0026gt;%\rselect(`Grande Região`, Trimestre, `Grupo de idade`, Rendimento)\rhead(tabela2, n = 3)\r## Grande Região Trimestre Grupo de idade Rendimento\r## 2 Norte 1º trimestre 2016 Total 1799\r## 3 Norte 1º trimestre 2016 14 a 17 anos 534\r## 4 Norte 1º trimestre 2016 18 a 24 anos 1127\r## Tabela 6372 - Média de horas habitualmente trabalhadas por semana e\r## efetivamente trabalhadas na semana de referência, no trabalho principal\r## e em todos os trabalhos, das pessoas de 14 anos ou mais de idade,\r## por grupos de idade\r#info_sidra(6372,wb = T)\rhoras \u0026lt;- get_sidra(\r6372,\rperiod = \u0026quot;201601-202001\u0026quot;,\rgeo = c(\u0026quot;Region\u0026quot;),\rvariable = c(8186),\rformat = 2\r)\rtabela3 \u0026lt;- horas %\u0026gt;%\rrename(\u0026quot;Horas\u0026quot; = Valor) %\u0026gt;%\rselect(`Grande Região`, Trimestre, `Grupo de idade`, Horas)\rhead(tabela3, n = 3)\r## Grande Região Trimestre Grupo de idade Horas\r## 2 Norte 1º trimestre 2016 Total 37.6\r## 3 Norte 1º trimestre 2016 14 a 17 anos 25.9\r## 4 Norte 1º trimestre 2016 18 a 24 anos 37.0\r## Tabela com todos os dados agrupados por `Grande Região`,\r## `Trimestre` e `Grupo de Idade`\remprego \u0026lt;- tabela1 %\u0026gt;%\rleft_join(tabela2) %\u0026gt;%\rleft_join(tabela3)\rhead(emprego, n = 2)\r## Grande Região Trimestre Grupo de idade Desocupacao Rendimento Horas\r## 1 Norte 1º trimestre 2016 Total 10.5 1799 37.6\r## 2 Norte 1º trimestre 2016 14 a 17 anos 24.4 534 25.9\rPortanto, a tabela chamada ``emprego’’ será a principal base para os gráficos.\nUm gráfico simples e muito comum é o de disperção, que é útil para relações entre duas variáveis quantitativas, como a relação entre horas trabalhadas e rendimento:\n # Gráfico de pontos\rggplot(emprego,\raes(x = Horas,\ry = Rendimento)) +\rgeom_point()\r\rFigure 3.1: Elaboração própria.\r\rNote que o sinal de + é usado para adicionar camadas ao gráfico como padrão do pacote. Uma elaboração mais completa dos gráficos envolve, normalmente, os seis componentes básicos e serão detalhados abaixo.\n3.1 Mapeamentos estéticos (variáveis)\rPode-se adicionar variáveis ao gráfico com a atribuição de cores (colour) e formato (shape) para variáveis categóricas e tamanho (size) para variáveis contínuas, que serão acompanhados de legenda.\nEstes elementos também podem ser utilizados de maneira cumulativa, contribuindo para uma visualização mais rápida.\nNote-se que é interessante maximizar a densidade de dados no gráfico. Se você tem poucos dados, utilize pontos, formatos ou linhas maiores. Vá reduzindo as geometrias à medida que seu conjunto de dados aumente, como o exemplo abaixo.\nVale notar que as estéticas passadas para o termo ggplot() valem para todas as camadas. As informações passadas como estéticas dos geoms valem apenas para a geometria específica.\nggplot(emprego,\raes(x = Horas,\ry = Rendimento,\rshape = `Grupo de idade`)) + # Diferencia elementos pelo formato\rgeom_point(size = 2.3) # Amplia a representação dos pontos \r\rFigure 3.2: Elaboração própria.\r\rSe a intenção é dar uma cor fixa para um determinado valor, usa-se o argumento fora do padrão aes() e na geometria de interesse.\nggplot(emprego,\raes(x = Horas,\ry = Rendimento,\rshape = `Grupo de idade`)) +\rgeom_point(color = \u0026quot;red\u0026quot;, # Adiciona uma cor a todas as informações\rsize = 2.3)\r\rFigure 3.3: Elaboração própria.\r\rPor outro lado, se seus dados começarem a representar muitas observações distintas, deve-se espalhar as informações em distintos gráficos comparáveis.\nNesse caso, pode-se adicionar variáveis categóricas por meio de facetas, que dividem o gráfico em subconjuntos. A forma mais simples é de modo wrapped, com o nome da variável precedido de um ~:\nggplot(emprego,\raes(x = Horas,\ry = Rendimento,\rcolor = `Grupo de idade`)) + # Diferencia elementos pelas cores\rgeom_point(shape = 1, # Formato fixo de círculo\rsize = 3)+ facet_wrap(~`Grande Região`)\r\rFigure 3.4: Elaboração própria.\r\r\r3.2 Geometrias (geoms)\rO pacote também fornece algumas geometrias diferentes que podem ser adaptadas às características dos dados a serem apresentados. Elas representam o “tipo” de gráfico que se quer apresentar. Note que é possível usar mais de uma geometria.\nCada tipo de dado tem sua geometria mais adequada e a página from data to vis apresenta um organograma didático sobre as melhores geometrias para sua necessidade.\nUm primeiro exemplo sobre o uso múltiplo de geometrias consiste em adicionar uma linha de regressão linear com o respectivo intervalo de confiança para os dados:\nggplot(emprego,\raes(x = Horas,\ry = Rendimento)) +\rgeom_point(size = 2.5,\ralpha = 0.4)+ # Alpha indica transparência dos pontos\rgeom_smooth(method = \u0026quot;lm\u0026quot;) # Adicion linha de regressão \r\rFigure 3.5: Elaboração própria.\r\rHistogramas e polígonos de frequência podem ser interessantes para mostrar a distribuição de uma única variável numérica. O temanho dos intervalos pode ser estabelecido com o argumento binwidth:\nggplot(emprego,\raes(x = Rendimento)) +\rgeom_histogram(fill = \u0026quot;blue\u0026quot;,\rbinwidth = 200) # Tamanho do intervalo\rggplot(emprego,\raes(x = Rendimento)) +\rgeom_freqpoly(color = \u0026quot;red\u0026quot;,\rsize = 2)\r\rFigure 3.6: Elaboração própria.\r\rVariáveis categóricas são automaticamente dispostas em ordem alfabética, mas podem ser reorganizadas conforme alguma variável quantitativa de referência com a função reorder(). Abaixo, um exemplo dessa alteração num boxplot.\nggplot(emprego,\raes(x = reorder(`Grupo de idade`,\rDesocupacao), # Critério para reordenar\ry = Desocupacao)) +\rgeom_boxplot()\r\rFigure 3.7: Elaboração própria.\r\r\r3.3 Eixos e escalas\rOs eixos podem ser customizados com alterações dos nomes (labels) e de seus tamanhos3 de modo a ficaram mais intuitivos e explicativos ao leitor.\nPara alterar nomes das regiões, pode-se usar a função labs().\nggplot(emprego,\raes(x = Horas,\ry = Rendimento)) +\rgeom_point(size = 2)+\rlabs(x = \u0026quot;Horas de Trabalho\u0026quot;,\ry = \u0026quot;Renda habitual\u0026quot;)\r\rFigure 3.8: Elaboração própria.\r\rA área de exibição dos eixos pode ser ajustada pelas funções xlim() e ylim().\nggplot(emprego,\raes(x = `Grande Região`,\ry = Rendimento,\rcolour = `Grupo de idade`)) +\rgeom_jitter(width = 0.3) + # Acrescenta variações para reduzir sobreposições\rlabs(\rx = NULL,\ry = NULL,\rtitle = \u0026quot;Renda por Região (R$)\u0026quot;,\rcolour = \u0026quot;Idade\u0026quot; # Título da legenda\r) +\rylim(c(700, 3100)) # Limite ao eixo y\r## Warning: Removed 106 rows containing missing values (geom_point).\r\rFigure 3.9: Elaboração própria.\r\rAs escalas também podem ser alteradas para padrões distintos de cores. Lembre-se de que a escolha de cores deve sempre ser feita de maneira intencional.\nPode-se usar as cores para distinguir variáveis categóricas, cujos valores não podem ser manipulados algebricamente.\nNesse caso, deve-se utilizar uma escala de cores qualitativa, em que não existe relação de ordem ou destaque de uma cor em relação às demais. Um exemplo está em Color Brewer. Há algumas escalas também disponíveis no ggplot2 como a apresentada na figura 3.10.\nTambém é possível usar cores para destacar, em que alguns poucos elementos realçados podem contribuir para a história que se quer representar. Isso pode ser feito com escalas de destaque está no livro de Claus O. Wilke.\nggplot(emprego,\raes(x = Horas,\ry = Rendimento)) +\rgeom_point(aes(colour = `Grupo de idade`)) +\rscale_y_log10() + # Escala do eixo y na base log_10\rscale_colour_brewer(palette = \u0026quot;Set1\u0026quot;) # Paleta de cores\r\rFigure 3.10: Elaboração própria.\r\rPode-se também fazer uma mudança de coordenadas para melhorar a visualização ou adaptar nomes mais longos de variáveis:\n # Horas de trabalho no eixo horizontal\rggplot(emprego,\raes(x = Horas,\ry = Rendimento)) +\rgeom_point(size = 2) +\rlabs(x = \u0026quot;Horas de Trabalho\u0026quot;,\ry = \u0026quot;Renda habitual\u0026quot;)\r# Horas de trabalho no eixo vertical\rggplot(emprego,\raes(x = Horas,\ry = Rendimento)) +\rgeom_point(size = 2) +\rlabs(x = \u0026quot;Horas de Trabalho\u0026quot;,\ry = \u0026quot;Renda habitual\u0026quot;) +\rcoord_flip() # Altera os eixos\r\rFigure 3.11: Elaboração própria.\r\rPor fim, o pacote também permite a visualização de mapas. A parte mais sensível é encontrar as coordenadas. Aqui, a apresentação será restrita a um mapa disponibilizado pelo pacote maps:\n # Download das coordenadas para formar o mapa do Brasil\rbrasil \u0026lt;- map_data(\u0026quot;world\u0026quot;, \u0026quot;brazil\u0026quot;) %\u0026gt;%\rselect(lon = long, lat, group, id = subregion)\rggplot(brasil,\raes(lon, lat)) +\rgeom_polygon(aes(group = group),\rfill = NA, # Mapa sem preenchimento\rcolour = \u0026quot;black\u0026quot;) + # Cor das bordas\rcoord_quickmap()\r\rFigure 3.12: Elaboração própria.\r\r\r3.4 Temas\rTemas alteram as propriedades estéticas dos gráficos sem que sejam alteradas as formas como as informações são apresentadas em geometrias ou como os eixos são escalonados. Há alguns temas já prontos, tanto do pacote ggplot2, quanto de extensões como o ggthemes.\nggplot(emprego,\raes(x = Horas,\ry = Rendimento)) +\rgeom_point(size = 2,\ralpha = 0.4)+\rgeom_smooth(method = \u0026quot;lm\u0026quot;)+\rtheme_stata() # Escolhe um tema pré-organizado\rggplot(emprego,\raes(x = Rendimento)) +\rgeom_freqpoly(color = \u0026quot;red\u0026quot;)+\rtheme_excel() # Escolhe um tema pré-organizado\r\rFigure 3.13: Elaboração própria.\r\r\r3.5 Séries de tempo e casos mais avançados\rPara séries de tempo, é interessante o uso de gráficos de linha, que ligam os pontos da esquerda para a direita, ou gráfico de trajeto, que liga os pontos conforme a ordem que aparecem na tabela.\nA forma como o SIDRA disponibiliza as tabelas oferece datas em formato de caracteres, o que prejudica a representação contínua em um dos eixos. Para isso, precisa-se transformar a informação para formato de data. Como os dados são trimestrais, faremos a transformação usando os pacotes tidyverse e zoo.\n # Ajuste para o formato de datas\remprego_data \u0026lt;- emprego %\u0026gt;%\rmutate(\rTrimestre = str_replace(Trimestre, \u0026quot;º trimestre \u0026quot;, \u0026quot;-\u0026quot;), # Ajuste da escrita\rTrimestre = as.yearqtr(Trimestre, format = \u0026quot;%q-%Y\u0026quot;) # Conversão para o formato de data trimestral\r)\rhead(emprego_data, n = 3)\r## Grande Região Trimestre Grupo de idade Desocupacao Rendimento Horas\r## 1 Norte 2016 Q1 Total 10.5 1799 37.6\r## 2 Norte 2016 Q1 14 a 17 anos 24.4 534 25.9\r## 3 Norte 2016 Q1 18 a 24 anos 23.2 1127 37.0\rPor fim, desejam-se apenas os dados de desocupados agregados para o Brasil em ordem cronológica como exemplo. Isso pode ser feito por:\nemprego_data %\u0026gt;% filter(`Grupo de idade` == \u0026quot;Total\u0026quot;) %\u0026gt;% # Seleciona Total ggplot(aes(x = Trimestre,\ry = Desocupacao,\rcolor = `Grande Região`)) +\rgeom_line(size = 1.25)\r\rFigure 3.14: Elaboração própria.\r\r\r\r4 Exercícios parte II\rCom base no explicado acima e nas referências Vale (2021, seções 12, 14 e 15) e Saulo Guerra et al. (2021, seções 4-6), resolva os seguintes exercícios usando as funções do pacote tidyverse.\n4.1 Manipulação de dados\rUtilize a tabela baixada do IBGE na lista anterior para as manipulações a seguir.\nImpute a tabela baixada para outro objeto, excluindo as colunas menos importantes na análise, tais como a de “Unidade de Medida,” “Nível Territorial,” “Variável” e etc.\n\rRenomeie a coluna de valores para um que seja mais intuitivo a respeito dos dados escolhidos. Não use expressões ou caracteres especiais.\n\rFaça ao menos uma operação com a coluna dos dados baixados para alterar a unidade de medida e manter intuição econômica ao mesmo tempo.\n\rPor meio das funções group_by e summarise, faça alguns cálculos com a variável numérica baixada agrupando por, pelo menos, outra coluna da tabela. Pode ser o cálculo da média, valores mínimos e máximos, desvio padrão e etc. Não é necessário atribuir a um novo objeto.\n\rFiltre os dados relacionados apenas aos últimos dois períodos — ano, trimestre e etc. — disponíveis. Também não é necessário imputar a um novo objeto.\n\rDesafio 1: Use a função pivot_wider para distribuir as informações da variável numérica em colunas de acordo com os distintos períodos de tempo filtrados na questão anterior.\n\rDesafio 2: A partir da tabela no formato wider, retorne-a ao formato longer, utilizando a função pivot_longer.\n\rBaixe outra tabela do IBGE com dados que apresentem atributos compatíveis com a tabela baixada na questão 3 da lista anterior. Depois disso, use a função left_join para juntar as duas tabelas. Certifique-se de que todas as colunas compatíveis foram lidas e devidamente acopladas.\n\r\r9.Desafio 3: A partir das funções str_replace e as.yearqtr (pacote zoo), transforme a coluna de data no formato de Date ou equivalente.\n\r4.2 Exportação de dados\rExporte todos as tabelas geradas nos exercícios anteriores para o formato .csv.\n\rExporte todos as tabelas geradas nos exercícios anteriores para o formato .xlsx.\n\r\r\r4.3 Elaboração de gráficos\rElabore um gráfico de pontos com os dados da tabela elaborada na questão 8 acima.\n\rAltere o formato dos pontos gráfico elaborado na questão acima para representar uma terceira variável.\n\rUtilize as facetas para separar as informações por uma quarta variável. Se o formato (shape) não se adaptar a uma variável contínua, mude o argumento de shape para colour.\n\rDê nome aos eixos e à legenda, título e informações extras (caption) ao gráfico da questão anterior.\n\r\rParabéns por ter chegado até aqui!  Espero que esses contatos inciais te motivem a continuar usando essa ferramenta potente para análise concreta da realidade concreta.\n\r\rReferências\rRobbins, Naomi B. 2004. Creating More Effective Graphs. New Jersey - USA: Wiley-Interscience. http://library1.nida.ac.th/termpaper6/sd/2554/19755.pdf.\r\rSaulo Guerra, Paulo Felipe de Oliveira, Robert McDonnell, and Sillas Gonzaga. 2021. Ciência de Dados com R - Introdução. Instituto Brasileiro de Pesquisa e Análise de Dados. http://sillasgonzaga.com/material/cdr/.\r\rVale, Vinícius A. 2021. “Introdução ao R.” https://viniciusavale.com/IntroR/Intro-R.html.\r\rWickham, Hadley. 2014. “Tidy Data.” Journal of Statistical Software 59 (10): 1–23. http://www.jstatsoft.org/.\r\r———. 2015. Elegant Graphics for Data Analysis. http://had.co.nz/ggplot2/book.\r\r\r\r\rEm tradução livre, “informação organizada.”↩︎\n\rAinda que nem todos sejam utilizados nesta nota, sugere-se a consulta de informações adicionais dos pacotes para conhecer melhor suas respectivas funcionalidades.↩︎\n\rA opção apresentada exclui as informações fora do intervalo. Para apenas aplicar um zoom sem que dados sejam eliminados, deve-se usar a opção coord_cartesian().↩︎\n\r\r\r","date":1630627200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1630707152,"objectID":"9aa3ba092fd2401a95f9674466c6143e","permalink":"/r-projetos/2a-lista/","publishdate":"2021-09-03T00:00:00Z","relpermalink":"/r-projetos/2a-lista/","section":"r-projetos","summary":"Introdução\r1 Manipulação e exportação de dados\r\r1.1 Apresentação típica\r1.2 Transposta da apresentação típica\r1.3 Tidy data\r1.4 Resumo para dados organizados\r\r2 Elaboração de gráficos\r3 Compontentes básicos dos gráficos\r\r3.","tags":["Intro Eco Pol","R"],"title":"Manipulação de dados, gráficos e segunda lista de exercícios","type":"r-projetos"},{"authors":[],"categories":[],"content":"\r\r\rIntrodução\r1 Por que usar o R?\r2 Download e Instalação\r\r2.1 R\r2.2 RStudio\r\r3 Primeiros comandos\r\r3.1 Ajuda do programa\r3.2 Começando um novo projeto\r\r4 Exercícios parte I\r\r4.1 Noções básicas de programação\r4.2 Importação de dados\r\rReferências\r\r\rIntrodução\rEsta nota tem por objetivo exercitar o ferramental básico para entender comandos que serão necessários nas próximas aulas1. A maior parte dos conteúdos serão relacionados às funcionalidades do R que são úteis para cientistas sociais. O curso não supõe conhecimento prévio de R, ainda que contatos anteriores permitirão um avanço mais rápido e concreto no curso.\nTrata-se de um trabalho experimental e inicial, que foi desenvolvido a partir de minha experiência concreta. Por favor, me indique eventuais erros e incongruências. Além disso, há trabalhos mais bem qualificados e em que me baseio para elaborar esses exercícios, como Wickham and Grolemund (2016), Wickham (2015) e Wickham (2014), cuja leitura é recomendada. Os textos em português de Vale (2021) e Saulo Guerra et al. (2021) também são fontes recomendadas de consulta.\n\r1 Por que usar o R?\rPara quem nunca teve contato com alguma linguagem de programação, este início costuma ser pouco amigável. Entretanto, há algumas vantagens em relação a editores de planilha como Excel ou Calc para acesso e manipulação de dados e elaboração de gráficos e apresentações:\nOs passos são descritos e registrados sequencialmente;\n\rA estrutura incremental (linha por linha) ajuda na identificação de erros;\n\rA discriminação dos passos auxilia na memória da pesquisa; e\n\rO script permite reprodutibilidade em outras pesquisas, contribuindo para o avanço da ciência.\n\r\rPortanto, todo o esforço inical e prática constante2 permitem uma adaptação rápida à linguagem e o acesso a dados estatísticos nacionais e internacionais que auxiliam na aprendizagem dos temas tratados na disciplina. Essas habilidades também podem ajudar para trabalhos de outras disciplinas ou de conclusão de curso.\n\r2 Download e Instalação\r2.1 R\rO primeiro passo é baixar e instalar o R em seu computador a partir de https://cran.r-project.org/. Faça o download de uma versão base adaptada ao seu sistema operacional. É recomendável utilizar uma versão 4.0 ou superior, para evitar problemas com pacotes no futuro. Instale o progama em seu computador, seguindo as configurações-padrão.\n\r2.2 RStudio\rApós os passos indicados na seção 2.1, deve-se baixar e instalar o RStudio, cuja versão gratuita para desktop está disponível em: https://www.rstudio.com/products/rstudio/download/. Com isso, tem-se uma interface mais organizada e ferramentas auxiliares para o uso do R.\nCaso tenham dúvidas na instalação, este vídeo a partir de 3min:30s pode ser útil: https://www.youtube.com/watch?v=WVogdSlk7gY.\n\r\r3 Primeiros comandos\rTradicionalmente, o primeiro programa que se faz em uma nova linguagem é dizer Alô, mundo!. No R, a função print() faz esse trabalho. Caso o comando esteja em um Rscript, basta selecionar ou manter o cursos sobre a(s) linha(s) que se deseja executar e acessar o comando “Run,” cujo atalho é CTRL+ENTER.\n # O resultado será exibido no console\rprint(\u0026quot;Alô, mundo!\u0026quot;)\rO estilo de programação usado aqui e nos Rscripts segue parte das orientações para indentação e organização dos códigos apresentados por Hadley Wickham (2021). Como o R apresenta estrutura mais flexível, seguir padrões contribui para que seu código seja lido com mais facilidade por outras pessoas.\n3.1 Ajuda do programa\rO R apresenta uma série de funções que são utilizadas para executar ações desejadas. Basta assinalar o nome da função sem parênteses, precidido de uma interrogação ?. Em geral, encontram-se a estrutura da função, seus atributos, detalhes e alguns exemplos. Este é um expediente que deve ser usado com frequência, especialmente por quem está tendo seus primeiros contatos com a linguagem\n # Um painel no RStudio exibirá ajuda sobre a função de concatenar\r?c\r\r3.2 Começando um novo projeto\rUm fluxo de trabalho interessante é iniciar um novo projeto no R para cada trabalho. Com isso, os arquivos ficarão todos organizados numa mesma pasta, facilitando a importação de dados e salvamento de arquivos. Isso pode ser feito no RStudio a partir de File \u0026gt; New Project. Ademais, é possível consultar o diretório de trabalho com a função getwd():\n # Descobre onde o projeto está trabalhando\rgetwd() \r\r\r4 Exercícios parte I\rConsiderando o que foi dito acima e os livros indicados no plano de curso, resolva os exercícios abaixo.\n4.1 Noções básicas de programação\rResolva as seguintes questões envolvendo noções básicas. A parte teórica está explicada em Vale (2021, seções 1-10) e Saulo Guerra et al. (2021, seções 1-2). Parte dos exercícios é cumulativa, de modo que é recomendável resolver os exercícios de modo sequencial e integral. Também é interessante sejam resolvidos em um novo Rproject e um novo Rscript.\nCrie seu primeiro programa na linguagem R, conforme explicado acima. Execute a linha do código com os comandos Ctrl + Enter (ou Cmd+Return para Mac).\n\rA partir da ajuda e exemplos, busque as seguintes informações:\nAjuda para as funções sum(); colSums(); sqrt(); lm(); setwd(); cbind(); data.frame().\n\rExemplos das funções sum e colSums.\n\r\rDescubra em qual diretório seu projeto está lendo e salvando arquivos.\n\rCrie os seguintes objetos com nomes distintos:\nNúmero de disciplinas que está cursando neste semestre.\rO nome do(a) professor(a) que está lecionando armazenado em um objeto com o mesmo nome da disciplina cursada.\r\rEscreva programas que manipulem as operações matemáticas básicas pelo menos uma vez com os números 50 e 65.\n\rCrie uma sequência de 2000 a 2021 de duas formas distintas.\n\rRepita a sequência criada na questão anterior por três vezes.\n\rQuais são os resultados das seguintes análises lógicas: TRUE \u0026amp; FALSE | FALSE, TRUE | FALSE | FALSE, TRUE | FALSE \u0026amp; FALSE e (TRUE | FALSE) \u0026amp; FALSE? Teste no R se você acertou o resultado.\n\rCrie vetores que contenham as seguintes informações do seu atual semestre. Dê nomes intuitivos para:\nOs nomes das disciplinas\rA quantidade de estudantes em cada disciplina\rOs códigos de horários de acordo com o SIGAA\rAs menções que você espera alcançar\r\rFaça as seguintes cálculos com o vetor do número de estudantes do exercício anterior:\nQual é a média de estudantes em suas turmas?\rSuponha que cada estudante receba 60 horas complementares por disciplina. Quantas horas seriam disponibilizadas em cada turma?\rQuantas horas seriam disponibilizadas em todas as turmas juntas?\r\rReescreva o vetor do número de estudantes, colocando as quantidades entre aspas. Qual é a classe do vetor criado?\n\rDesafio: qual é a posição no vetor das turmas que têm mais estudantes do que a média de todas as turmas?\n\rUtilize a função data.frame para criar uma tabela com as informações da questão anterior. Nomeie as colunas com nomes indicativos do conteúdo.\n\rImpute a tabela gerada na questão anterior para um objeto chamado meu_sigaa. Visualize a tabela em outra aba do RStudio.\n\rA partir da tabela meu_sigaa:\nLeia apenas a primeira linha.\n\rLeia apenas a primeira coluna, filtrando por seu nome (atente-se para erros de leituras de caracteres especiais nos nomes das colunas).\n\rRetorne o número de estudantes da disciplina de Introdução à Economia Política.\n\r\rCertifique-se de que instalou corretamente os seguintes pacotes: tidyverse, ggthemes, scales, writexl, sidrar e devtools.\n\rUse a ajuda do R para acessar informações sobre as funções get_sidra e info_sidra.\n\rBusque informações sobre a tabela 6320, depositada no Sistema IBGE de Recuperação Automática - SIDRA.\n\r\r\r4.2 Importação de dados\rSobre importação dos dados, serão tratados tanto dados baixados manualmente de alguma fonte externa ou acessados internamente por meio de algum pacote específico capaz de acessar bancos de dados de interesse.\nA parte teórica está explicada em Vale (2021, seções 11 e 13) e Saulo Guerra et al. (2021, seção 3). Lembre-se de carregar os pacotes sempre que iniciar uma nova sessão no R.\n # Pacotes para esta questão\rlibrary(readxl) # Carregamento tabelas do Excel\rlibrary(sidrar) # Repositório IBGE\rlibrary(wid) # World Inequality Database # Pacotes úteis para as próximas questões\rlibrary(tidyverse) # Organização das tabelas e elaboração de gráficos\rlibrary(ggthemes) # Interfaces gráficas adicionais\rlibrary(scales) # Ajuste de escala dos gráficos\rlibrary(writexl) # Salvamento tabelas em formato Excel\rlibrary(zoo) # Ajuste de datas\rApós, resolva as seguintes questões.\nAcesse o site do IBGE, localize uma estatística social ou econômica de seu interesse, baixe um arquivo em formato .xls ou .xlsx e salve na mesma pasta em que está seu projeto. Em seguida:\nEscreva uma função para fazer a leitura da tabela a partir do caminho relativo em seu computador.\n\rIndique a planilha a ser importada utilizando o seu nome no arquivo original.\n\rCrie um vetor com o(s) nome(s) das colunas e importe a tabela com o(s) novo(s) nome(s).\n\rDê um nome sugestivo à tabela importada, atribuindo-a a um objeto dentro do R.\n\r\rDesafio: acesse o Sistema Gerenciador de Séries Temporais do Banco Central do Brasil (BCB) e baixe uma série organizada pelo próprio BCB em formato .csv. Salve a tabela na mesma pasta em que está seu projeto. Em seguida:\nEscreva uma função para fazer a leitura da tabela a partir do caminho relativo em seu computador.\n\rCrie um vetor com o(s) nome(s) das colunas e importe a tabela com o(s) novo(s) nome(s).\n\rPossivelmente o tipo das colunas não condiz com os dados efetivamente. Reescreva a função, indicando os tipos das colunas.\n\rDê um nome sugestivo à tabela importada, atribuindo-a a um objeto dentro do R.\n\r\rUtilizando o pacote sidrar, localize informações sobre alguma série coletada pelo IBGE e relacionada ao mercado de trabalho. Em seguida:\nConsulte as séries disponíveis com a função própria do pacote a partir de uma palavra-chave.\n\rAcesse as informações da série de interesse no próprio console ou no navegador de internet.\n\rFaça um teste importando a série apenas pelo seu número.\n\rRefaça o procedimento do item c, agora especificando os demais parâmetros de interesse e atribuindo a um objeto específico.\n\r\rConsulte o dicionário de códigos da World Inequality Database e importe com a função download_wid os seguintes dados:\nDesafio: coeficiente de GINI da distribuição de renda para o Brasil e para algum outro país a sua escolha, para fazer a comparação. Impute a um objeto.\n\rFração (share) da renda apropriada pelo 1% mais rico e pelos 50% mais pobres do ponto de vista dos indivíduos em um país da América Latina, um da Europa e um da Ásia.\n\r\r\r\r\rReferências\rHadley Wickham. 2021. The tidyverse style guide. https://style.tidyverse.org/.\r\rSaulo Guerra, Paulo Felipe de Oliveira, Robert McDonnell, and Sillas Gonzaga. 2021. Ciência de Dados com R - Introdução. Instituto Brasileiro de Pesquisa e Análise de Dados. http://sillasgonzaga.com/material/cdr/.\r\rVale, Vinícius A. 2021. “Introdução ao R.” https://viniciusavale.com/IntroR/Intro-R.html.\r\rWickham, Hadley. 2014. “Tidy Data.” Journal of Statistical Software 59 (10): 1–23. http://www.jstatsoft.org/.\r\r———. 2015. Elegant Graphics for Data Analysis. http://had.co.nz/ggplot2/book.\r\rWickham, Hadley, and Garrett Grolemund. 2016. R for data science: import, tidy, transform, visualize, and model data. \" O’Reilly Media, Inc.\".\r\r\r\r\rA primeira elaboração desses materiais se deu para o curso de Introdução à Economia Política, oferecida por mim no Departamento de Economia da Universidade de Brasília no 1o semestre de 2021↩︎\n\rUma boa estratégia é tentar adaptar o R às rotinas próprias, acadêmicas ou não, em substituição ao Excel, por exemplo. Além de ser uma ferramenta gratuita, pode ser usada como editor de texto, de apresentações e de gráficos. Entre outras razões, tais funcionalidades fazem com que o software seja bastante utilizado por estatísticos e cientistas sociais em geral.↩︎\n\r\r\r","date":1625356800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1625412764,"objectID":"3bdcbec96ce111acfaa35569090381c3","permalink":"/r-projetos/1a-lista/","publishdate":"2021-07-04T00:00:00Z","relpermalink":"/r-projetos/1a-lista/","section":"r-projetos","summary":"Introdução\r1 Por que usar o R?\r2 Download e Instalação\r\r2.1 R\r2.2 RStudio\r\r3 Primeiros comandos\r\r3.1 Ajuda do programa\r3.2 Começando um novo projeto\r\r4 Exercícios parte I\r\r4.","tags":["R","Intro Eco Pol"],"title":"Aulas iniciais e primeira lista de exercícios","type":"r-projetos"},{"authors":[],"categories":[],"content":"\r\r\rIntrodução\rOrganizando a tabela\rConstruindo os gráficos\r\rIntegração Inversa\rClasse Especial\rFormatos adicionais\r\rReferências\r\r\rTrabalho elaborado por Luana de Melo Ribas1 e Rafael de Acypreste2\nIntrodução\rEsta nota tem por objetivo explicar e exemplificar os passos para elaboração de um gráfico de linha do tempo com os informações de estudo exploratório e faz parte da dissertação de mestrado da primeira autora. É permitida a reprodução desde que citada a fonte.\nPara discutir os informações observados no estudo exploratório utilizou-se análise microgenética de videogravações em contexto escolar e, para essa análise, foi usado o software ELAN 5.73. Para mais informações, consulte Lausberg and Sloetjes (2009). A organização de tabelas e elaboração dos gráficos foi realizada com o software estatístico R. Os passos abaixo detalham os procedimentos adotados neste último.\nInicialmente, vale ressaltar que, sempre que possível, deve-se evitar o uso de caracteres especias — como *, (), ç — e acentos tanto nos nomes das variáveis quanto nos nomes dos arquivos. Computadores, em geral, têm dificuldade para ler e interpretar esses sinais, sendo fonte comum de erros de sintaxe, em que o programa para sua execução.\nTambém sugerimos que todos os procedimentos para manipulação dos “dados brutos” gerados no ELAN sejam feitos diretamente no R. Ainda que a estrutura de linguagem de programação seja pouco amigável nos primeiros usos, há algumas vantagens em relação a editores de planilha como Excel ou Calc:\nOs passos são descritos e registrados sequencialmente;\n\rA estrutura incremental (linha por linha) ajuda na identificação de erros;\n\rA discriminação dos passos auxilia na memória da pesquisa; e\n\rO script permite reprodutibilidade em outras pesquisas, contribuindo para o avanço da ciência.\n\r\rAssim, essa nota pretende explicitar os procedimentos adotados nas informações utilizadas na dissertação e servir de guia para pesquisas futuras.\nAntes de começar, vamos carregar os pacotes do R necessários com a função library. Caso nunca tenha sido usados em uma máquina, devem ser instalados antes do primeiro uso com a função install.packages e, depois, carregados.\n# install.packages(\u0026quot;tidyverse\u0026quot;) Instala o pacote tidyverse, por exemplo\rlibrary(tidyverse) # Organização das tabelas e elaboração de gráficos\rlibrary(readxl) # Carregamento tabelas do Excel\rlibrary(writexl) # Salvamento tabelas em formato Excel\rlibrary(RColorBrewer) # Paletas de cores para os gráficos\rlibrary(viridis) # Paletas de cores para os gráficos\rlibrary(ggthemes) # Interfaces gráficas adicionais\rlibrary(scales) # Ajuste de escala dos gráficos\r\rOrganizando a tabela\rA exportação de informações do Elan produz tabelas em alguns formatos. Para a presente nota, interessa o formato .csv4. Entretanto, as informações diponibilizados não se encontram no formato ideal para a apresentação de tabelas e elaboração de gráficos. Portanto, é necessária alguma manipulação da tabela para que as informações fiquem devidamente organizadas, isto é, para que as informações permitam uma ligação entre sua disposição física e sua semântica.\nEsse processo de organização leva à chamada ``tidy data’’5 (por isso o nome do primeiro pacote utilizado), conforme Wickham (2014). Em síntese, os informações devem ser organizados de duas formas. Cada valor (cada célula numa tabela do Excel) pertence a uma variável e uma observação. Variável contém valores que se referem a uma mesma característica ou atributo — no presente caso, podemos citar os períodos inicial, final, duração, as pessoas, as categorias e as subcategorias — e são representadas por colunas. Cada observação, isto é, cada linha contém todos os valores medidos sobre uma mesma unidade, como uma pessoa ou um dia — no caso das informações no Elan, cada pessoa em uma categoria e um período de tempo representa uma observação.\nPodemos perceber que a forma como o ELAN disponibiliza as informações não atende ao requisito de informação tidy. Portanto, o ajuste será feito no próprio R. O primeiro passo é importar o arquivo e isso se dá indicando onde o arquivo original está salvo. Notem que o acesso a uma planilha II_no_salao_opcao_2.csv precisa indicar todos os caminhos. Sugerimos que todas as tabelas sejam salvas numa mesma pasta e preferencialmente no mesmo diretório que estão salvos as informações da sessão do R6.\nNessa nota, são usadas distintas funções. Para informações sobre uma função, sugerimos consultar a ajuda do próprio programa, que pode ser acessada por meio do código ?nomedafunção no console, como ?read_csv.\n# Lê o arquivo do ELAN e salva no objeto \u0026quot;salao_csv2\u0026quot;\rtabela \u0026lt;- \u0026quot;C:/Users/rafae/OneDrive/Documentos/Luana/data/II_no_salao_opcao_2.csv\u0026quot;\rsalao_csv2 \u0026lt;- read_csv(tabela,\rlocale = locale(encoding = \u0026quot;ISO-8859-1\u0026quot;),\rcol_types = cols(`Tempo Inicial - hh:mm:ss.ms` =\rcol_time(format = \u0026quot;%H:%M:%OS\u0026quot;),\r`Tempo Final - hh:mm:ss.ms` =\rcol_time(format = \u0026quot;%H:%M:%OS\u0026quot;)))\r# \u0026quot;ISO-8859-1\u0026quot; é formato que melhor se adapta às pontuações do Português\r# Sugerimos usar esse formato ao Exportar as informações do próprio ELAN\r# O formato de tempo precisa ser ajustado a partir do comando \u0026quot;col_types\u0026quot;\rsalao_csv2[1:3,] # Mostra as três primeiras linhas\r## # A tibble: 3 x 10\r## `Tempo Inicial ~ `Tempo Final - ~ `Duração - hh:m~ `MM Asp da Com ~\r## \u0026lt;time\u0026gt; \u0026lt;time\u0026gt; \u0026lt;time\u0026gt; \u0026lt;chr\u0026gt; ## 1 01\u0026#39;54.000\u0026quot; 01\u0026#39;55.270\u0026quot; 00\u0026#39;01\u0026quot; observa ação ou~\r## 2 01\u0026#39;55.285\u0026quot; 01\u0026#39;57.015\u0026quot; 00\u0026#39;01\u0026quot; interrogativo ## 3 01\u0026#39;57.015\u0026quot; 01\u0026#39;59.220\u0026quot; 00\u0026#39;02\u0026quot; imperativo ## # ... with 6 more variables: `MS Asp da Com e Int Social` \u0026lt;chr\u0026gt;, `MM Usos dos\r## # objetos/brinquedos` \u0026lt;chr\u0026gt;, `MS Usos dos objetos/brinquedos` \u0026lt;chr\u0026gt;, `Profa\r## # Asp da Com e Int Social` \u0026lt;chr\u0026gt;, `Profa Usos dos objetos/brinquedos` \u0026lt;chr\u0026gt;,\r## # X10 \u0026lt;chr\u0026gt;\rPodemos notar que as colunas indicadas com letras maiúsculas configuram o par ``pessoa/categoria’’ do ELAN, que são valores da tabela. Portanto, deveriam formar duas variáveis distintas e não várias colunas7. Uma das consequências comuns de valores serem colocados em colunas é a profusão de células vazias. Vale ressaltar que a última coluna não faz parte das informações e será excluída nos próximos passos.\nAssim, vamos reorganizar a tabela para que as trilhas façam parte de apenas uma variável e excluir a coluna extra e as células vazias. Salvaremos a tabela em um novo objeto. Os passos serão adotados usando os pipes — %\u0026gt;% —, em que se pode consultar mais informações sobre seu uso aqui.\nsalao2 \u0026lt;- salao_csv2 %\u0026gt;% # Atribui ao objeto \u0026quot;salao\u0026quot;\rselect(-\u0026quot;X10\u0026quot;) %\u0026gt;% # Exclui a coluna adicionada erroneamente\rpivot_longer(cols = `MM Asp da Com e Int Social`: # Seleciona valores da\r`Profa Usos dos objetos/brinquedos`,# variável temporária\rnames_to = \u0026quot;trilha\u0026quot;, # Local para nomes das colunas\rvalues_to = \u0026quot;subcategoria\u0026quot;) %\u0026gt;% # Local para os valores\rfilter(subcategoria != \u0026quot;\u0026quot;) %\u0026gt;% # Exclui as células em branco\rarrange(trilha,subcategoria) %\u0026gt;% # Ordem alfabética das trilhas\rselect(4,5,1,2,3) # Muda a ordem das colunas salao2[1:3,] # Exemplo novas colunas\r## # A tibble: 3 x 5\r## trilha subcategoria `Tempo Inicial - ~ `Tempo Final - h~ `Duração - hh:mm~\r## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;time\u0026gt; \u0026lt;time\u0026gt; \u0026lt;time\u0026gt; ## 1 MM Asp da~ apontar 02\u0026#39;10.139\u0026quot; 02\u0026#39;11.009\u0026quot; 00\u0026#39;00\u0026quot; ## 2 MM Asp da~ apontar 03\u0026#39;41.390\u0026quot; 03\u0026#39;43.800\u0026quot; 00\u0026#39;02\u0026quot; ## 3 MM Asp da~ declarativo 02\u0026#39;06.810\u0026quot; 02\u0026#39;08.789\u0026quot; 00\u0026#39;01\u0026quot;\rAgora, o último passo é colocar nomes mais sugestivos às colunas e alterar a estrutura do tipo de coluna referente ao tempo. Deixaremos o nome em formato amigável. Também faremos alguns ajustes de sintaxe do R para que o gráfico se dê na ordem mais interessante para apresentação da pesquisa. Por fim, salvaremos a tabela organizada em uma nova planilha em formato compatível com Excel.\nsalao2 \u0026lt;- salao2 %\u0026gt;% rename(\u0026quot;t_inicial\u0026quot; = `Tempo Inicial - hh:mm:ss.ms`, # Renomeia coluna\r\u0026quot;t_final\u0026quot; = `Tempo Final - hh:mm:ss.ms`) %\u0026gt;% mutate(t_inicial = t_inicial - parse_time(\u0026quot;00:01:48\u0026quot;), # Renova o eixo x\rt_final = t_final - parse_time(\u0026quot;00:01:48\u0026quot;), # para começar em zero\r\u0026quot;pessoa\u0026quot; = str_extract(trilha,\u0026quot;MM|MS|Profa\u0026quot;), # Ajusta informações das\rpessoa = str_replace(pessoa,\u0026quot;Profa\u0026quot;,\u0026quot;Professora\u0026quot;), # duas novas colunas\rpessoa = str_replace(pessoa,\u0026quot;MS\u0026quot;,\u0026quot;MaxSteel\u0026quot;),\rpessoa = str_replace(pessoa,\u0026quot;MM\u0026quot;,\u0026quot;Mulher Maravilha\u0026quot;),\r\u0026quot;categoria\u0026quot; = str_extract(trilha,\u0026quot;Uso.*|Asp.*\u0026quot;)) %\u0026gt;% select(-1) %\u0026gt;% # Exclui coluna temporária\rmutate(categoria = str_replace(categoria,\u0026quot;Asp da Com e Int Social\u0026quot;,\u0026quot;Aspectos da Comunicação/Interação\u0026quot;),\rcategoria = str_replace(categoria,\u0026quot;Usos\u0026quot;,\u0026quot;Uso\u0026quot;),\rsubcategoria = str_replace(subcategoria,\u0026quot;observa ação/outro\u0026quot;,\u0026quot;observa ação outro\u0026quot;),\rsubcategoria = str_replace(subcategoria,\u0026quot;poduz\u0026quot;,\u0026quot;produz\u0026quot;),\rsubcategoria = as_factor(subcategoria),\rcategoria = factor(categoria,levels = unique(categoria))) # Reordena\r# Salva a tabela em formato .xlsx (Excel)\rwrite_xlsx(salao2,\u0026quot;C:/Users/rafae/OneDrive/Documentos/Luana/data/salao2.xlsx\u0026quot;) salao2[1:3,]\r## # A tibble: 3 x 6\r## subcategoria t_inicial t_final `Duração - hh:mm:~ pessoa categoria ## \u0026lt;fct\u0026gt; \u0026lt;drtn\u0026gt; \u0026lt;drtn\u0026gt; \u0026lt;time\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;fct\u0026gt; ## 1 apontar 22.139 s~ 23.009 ~ 00\u0026#39;00\u0026quot; Mulher M~ Aspectos da Co~\r## 2 apontar 113.390 s~ 115.800 ~ 00\u0026#39;02\u0026quot; Mulher M~ Aspectos da Co~\r## 3 declarativo 18.810 s~ 20.789 ~ 00\u0026#39;01\u0026quot; Mulher M~ Aspectos da Co~\rCom a tabela no formato adequado, passemos à elaboração dos gráficos.\n\rConstruindo os gráficos\rPara a base dos gráficos, usaremos a função geom_segment do pacote ggplot2, como se pode ver na Figura 1. Como as categorias e subcategorias farão parte da explicação das linhas do tempo e parte da legenda no gráfico, sugerimos que sejam escolhidas criteriosamente pela pesquisadora e pelo pesquisador. Quanto maior a quantidade, mais informações e cores precisarão estar disponíveis no gráfico, o que pode prejudicar a inteligibilidade.\n?geom_segment # Consultar informações\rIntegração Inversa\rPor fim, o gráfico pode ser customizado conforme interesse da pesquisa e salvo. As principais ferramentas utilizadas estão no pacote ggplot2. Uma folha de resumo deste pacote pode ser encontrada aqui. Há também modelos de gráficos adicionais e cores no pacote ggthemes. A interface apresentada na dissertação se dá abaixo.\nsalao2_plot \u0026lt;- salao2 %\u0026gt;% ggplot()+ # Elabora gráfico\rgeom_segment(aes(x = t_inicial, xend = t_final, # Eixo x - Tempo\ry = pessoa, yend = pessoa, # Eixo y - códigos-mãe\rcolor = subcategoria), # Informações legenda\rsize = 10)+ # Largura dos segmentos\rfacet_grid(categoria ~ ., # Divisão códigos-filho\rscales = \u0026quot;free_y\u0026quot;)+ theme_hc()+ # Tema do gráfico\rlabs(x = NULL, # Nomes no gráfico\ry = NULL,\rtitle = \u0026quot;Integração Inversa\u0026quot;,\rsubtitle = \u0026quot;Relação triádica criança com autismo - objeto/brinquedo - outro\u0026quot;,\rcaption = \u0026quot;Fonte: Elaboração própria.\u0026quot;,\rtheme(legend.position = \u0026quot;bottom\u0026quot;),\rcolor = NULL)+\rtheme(legend.position=\u0026quot;right\u0026quot;)+ # Legenda à direita\rscale_x_time(labels=time_format(\u0026quot;%H:%M:%S\u0026quot;))+ # Nomes eixo tempo\rscale_color_manual(values = c(\u0026quot;#ffd94a\u0026quot;,\u0026quot;#c7c7c7\u0026quot;,\u0026quot;#2ca02c\u0026quot;,\u0026quot;#9467bd\u0026quot;,\r\u0026quot;#ff7f0e\u0026quot;,\u0026quot;#98df8a\u0026quot;,\u0026quot;#8c564b\u0026quot;,\u0026quot;#1f77b4\u0026quot;,\r\u0026quot;#e377c2\u0026quot;,\u0026quot;#9edae5\u0026quot;,\u0026quot;#d62728\u0026quot;,\r\u0026quot;#ff9896\u0026quot;,\u0026quot;#7f7f7f\u0026quot;)) # Cores\r# Salva o gráfico\rggsave(plot = salao2_plot,\u0026quot;C:/Users/rafae/OneDrive/Documentos/Luana/figures/salao2.jpg\u0026quot;,\rwidth = 12, height = 8) salao2_plot\r\rFigure 1: Elaboração própria.\r\rPodemos também selecionar tempos menores para exibição dos gráficos. O zoom pode ser feito com o comando coord_cartesian().\n\rClasse Especial\rPassos semelhantes foram adotados para as informações da Classe Especial.\rOs resultados são visualizados na figura 2.\n\rFigure 2: Elaboração própria.\r\r\rFormatos adicionais\rPor fim, a título de exemplo, seria possível elaborar com outro layout de gráfico e paleta de cores como nas Figuras 3 e 4:\n\rFigure 3: Elaboração própria.\r\r\rFigure 4: Elaboração própria.\r\r\r\rReferências\rLausberg, Hedda, and Han Sloetjes. 2009. “Coding gestural behavior with the NEUROGES-ELAN system.” Behavior Research Methods 41 (3): 841–49. https://doi.org/10.3758/BRM.41.3.841.\r\rWickham, Hadley. 2014. “Tidy Data.” Journal of Statistical Software 59 (10): 1–23. http://www.jstatsoft.org/.\r\r\r\r\rMestranda em Psicologia do Desenvolvimento e Escolar pela Universidade de Brasília. Pode ser contatada em luana.psi@hotmail.com.↩︎\n\rDoutorando em Economia pela Universidade de Brasília. Pode ser contatado em rafaeldeacyprestemr@gmail.com.↩︎\n\rO download está disponível em https://archive.mpi.nl/tla/elan. O programa foi criado pelo Max Planck Institute for Psycholinguistics, The Language Archive, Nijmegen, The Netherlands.↩︎\n\rSugerimos utilizar o formato “ISO-8859-1” ao exportar as informações do próprio ELAN.↩︎\n\rEm tradução livre, “informação organizada.”↩︎\n\rO diretório local pode ser acessado digitando getwd() no Console do R.↩︎\n\rA separação em duas colunas envolve um passo intermediário, que será feito por uma coluna temporária chamada “trilha.”↩︎\n\r\r\r","date":1618963200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618932236,"objectID":"1bc16c96c2341e3cda7788171c627cf5","permalink":"/r-projetos/elan/","publishdate":"2021-04-21T00:00:00Z","relpermalink":"/r-projetos/elan/","section":"r-projetos","summary":"Introdução\rOrganizando a tabela\rConstruindo os gráficos\r\rIntegração Inversa\rClasse Especial\rFormatos adicionais\r\rReferências\r\r\rTrabalho elaborado por Luana de Melo Ribas1 e Rafael de Acypreste2","tags":["R"],"title":"Organização de tabelas e elaboração de gráficos a partir de análises com Elan 5.7","type":"r-projetos"},{"authors":[],"categories":[],"content":"\r\r\r1 Introdução\r2 EDOs de 1a ordem\r\r2.1 Estrutura básica para simulação com R\r2.2 Interrupção automática da simulação\r\r3 EDOs de 2a ordem\r\r3.1 Equação com coeficientes constantes\r3.2 Equação de Laguerre\r3.3 Equação de Euler\r\r4 Equações diferenciais simultâneas\r5 Análise de estabilidade\r\r5.1 Estabilidade de EDO de 1a ordem\r\r5.1.1 Retrato de fase\r\r5.2 Estabilidade de sistema de duas EDOs de 1a ordem - equilíbrio dinâmico\r5.3 Estabilidade de sistema de duas EDOs de 1a ordem - ponto de sela\r\rReferências\r\r\rRafael de Acypreste1 e Theo Antunes2\n1 Introdução\rO objetivo geral desta nota é realizar simulações numéricas de equações diferenciais ordinárias com ênfase, especialmente, em aplicações econômicas. Todas as simulações são feitas utilizando-se o software R. Este trabalho teve como referência os trabalhos realizados pelo professor Júlio Fernando Costa Santos3\nPara as simulações, serão utilizados os pacotes abaixo, adicionais à base do R. É preciso que sejam instalados (uma única vez) e carregados antes do uso:\n# install.packages(\u0026quot;deSolve\u0026quot;)\r# install.packages(\u0026quot;PhaseR\u0026quot;)\r# install.packages(\u0026quot;scatterplot3d\u0026quot;)\r# install.packages(\u0026quot;latex2exp\u0026quot;)\rlibrary(deSolve) # Funções para resolver EDOs\rlibrary(phaseR) # Funções para elaboração dos retratos de fase\rlibrary(scatterplot3d) # Gráficos em 3 dimensões\rlibrary(latex2exp) # Expressões escritas padrão LaTeX\roptions(scipen = 99) # Utiliza 99 casas decimais como padrão em vez de notação científica\rDenota-se por equação diferencial ordinária (EDO) uma função desconhecida e a relação com suas derivadas. Como, em economia, costuma-se usar o tempo como variável independente, esta notação permanecerá ao longo do texto se não estiver disposto de outra maneira. Portanto, pode-se representar uma EDO de ordem \\(n\\) por\n\\[\\begin{equation}\rf[y(t),y^{(1)}(t),y^{(2)}(t),...,y^{(n)}(t),t ] = 0\r\\tag{1.1}\r\\end{equation}\\]\nem que \\((n)\\) é o grau da EDO e representa a maior ordem das derivadas da função desconhecida Seco and Patrão (2018). Uma notação da forma geral pode ser descrita por:\n\\[\\begin{equation}\ra_n(t)y^{(n)}(t)+\\dots+a_2(t)y^{(2)}(t)+a_1(t)y^{(1)}(t)+a_0(t)y(t) = g(t) \\tag{1.2}\r\\end{equation}\\]\nNeste texto, não serão abordados detalhes teóricos sobre equações diferenciais e sobre os modelos apresentados. O(a) leitor(a) deve recorrer aos documentos citados em caso de interesse.\n\r2 EDOs de 1a ordem\rEDOs de 1a ordem envolvem uma equação em termos da sua primeira derivada \\(y\u0026#39;(t)\\). Conforme Gandolfo (2005), pode-se encontrar uma solução de uma equação homogênea no formato \\(y(t) = Ae^{-bt}\\), cuja estabilidade depende do sinal de \\(-b\\). Alguns exemplos de equações na Figura 2.1.\nApesar de servir de motivação para a análise de EDOs, o objetivo desta nota não é resolver EDOs, encontrando uma função \\(y(t)\\) que a satisfaz, mas sim identificar o comportamento de tais equações a partir de resoluções numéricas e representações gráficas. Portanto, passa-se aos detalhes básicos para as simulações.\n\rFigure 2.1: Elaboração própria.\r\r2.1 Estrutura básica para simulação com R\rAlgumas equações diferenciais apresentam soluções analíticas, que podem ser resolvidas a partir de técnicas específicas. Para a economia, uma boa referência é o livro do Gandolfo (2005). Para aplicações mais detalhadas, consultar Seco and Patrão (2018). Nesses casos, simples técnicas de elaboração de gráficos podem ser adotadas no R ou outro software.\nPorém, há situações que não se deseja ou não é simples encontrar uma solução analítica. Para esses casos, o R possui pacotes que ajudam a encontrar e representar graficamente soluções numéricas e retratos de fase, que podem ajudar na interpretação dos modelos.\nO pacote utilizado para simulação e resolução de EDOs com o R é o deSolve. Um espectro maior de aplicações e parte das explicações aqui apresentadas podem ser encontradas em Soetaert, Petzoldt, and Setzer (2010)}. Recursos adicionais e manuais podem ser acessados digitando ?deSolve diretamente no console4.\nEm primeiro lugar, deve-se definir uma função própria do modelo a ser simulado em linguagem própria do R com, no mínimo, os seguintes parâmetros nesta ordem:\nTempo para simulação;\rValor inicial das variáveis (estado); e\rParâmetros do modelo.\r\rQuando da resolução, o modelo chamará essa função em cada período de tempo durante o processo de integração. Tempo e valores iniciais devem ser disponibilizados no formato de vetores (ou listas). A função with( )5 permite usar as variáveis em formato de lista diretamente dentro da função sem que seja necessário indicar o nome da lista todas as vezes. Por fim, a função deve retornar uma lista (os resultados serão concatenados se estivermos interessados em mais de uma EDO). Os comandos estão detalhados abaixo.\nCom a função elaborada, são estabelecidos os nomes e valores dos parâmetros, a(s) condição(ões) inicial(is) e o período de tempo que se deseja fazer a simulação. Lembre-se de que, quanto maior o tempo e complexidade do modelo, maior será o nível de exigência computacional6.\nComo exemplo de EDO de 1a ordem, pode-se simular o seguinte modelo, baseado no modelo canônico de Solow (1956)7 representado na equação (2.1).\r\\[\\begin{equation}\r\\dot{r} = sF(r,1) - nr\r\\tag{2.1}\r\\end{equation}\\] em que \\(r = \\frac{K}{L}\\) é a razão capital-trabalho, \\(s\\) é a taxa de poupança, \\(n\\) é a taxa de crescimento da força de trabalho e \\(F(r,1)\\) é uma função de produção homogênea de grau um a ser especificada.\nNo presente caso, uma função Cobb-Douglas na forma \\(F(K,L) = K^\\alpha L^{1-\\alpha} \\Rightarrow F(r,1) = r^\\alpha\\) pode ser adotada para a resolução numérica. Portanto, a equação diferencial a ser simulada é:\r\\[\\begin{equation}\r\\dot{r} = sr^\\alpha - nr\r\\tag{2.2}\r\\end{equation}\\] cuja função para simuação da EDO pode ser construída por:\n ### Função em R que representa a EDO\rsolow_edo \u0026lt;- function(tempo, inicial, parametros){ # Parâmetros da função\rlist \u0026lt;- as.list(c(inicial, parametros)) # Lista c/ informações da EDO\rwith(list, { # with() acessa elementos da lista\rdr = s*r^alpha - n*r # EDO de interesse\rlist(dr) # Retorna valores simulados\r}) # Fim do with\r} # Fim da função\rA partir da função solow_edo criada, pode-se disponibilizar os dados específicos a partir da simulação com a função ode( ). Os valores dos parâmetros foram \\(s = 0.1\\), \\(\\alpha = 0.35\\) e \\(n = 0.05\\) e o valor inicial \\(r_0 = 1\\). Ao final, estão os três primeiros e últimos resultados:\n ### Valor inicial r \u0026lt;- c(r = 1) # Formato de vetor nominado de acordo com a função\r### Parâmetros da função (podem ser estimados)\rparametros \u0026lt;- c(s = 0.1,\ralpha = 0.35,\rn = 0.05) # Formato de vetor\r### Sequência de tempo\rtempo \u0026lt;- seq(0, 350, by = 1) ### Simulação do modelo solow \u0026lt;- ode(y = r, # Condição inicial\rtimes = tempo, # Tempo a ser simulado\rfunc = solow_edo, # Função criada\rparms = parametros) # Se parâmetros já definidos, use parms = NULL\r### Exibição dos resultados\rhead(solow, n=3) # Exibe três primeiros\r## time r\r## [1,] 0 1.000000\r## [2,] 1 1.049617\r## [3,] 2 1.098443\rtail(solow, n=3) # Exibe três últimos\r## time r\r## [349,] 348 2.904818\r## [350,] 349 2.904819\r## [351,] 350 2.904820\rO gráfico resultado do modelo está descrito na Figura 2.2, sob o título “Modelo de Solow.”\n\r2.2 Interrupção automática da simulação\rCaso o interesse seja só a fase inicial de uma equação ou se tenha uma EDO convergente, é possível usar a funcionalidade root da função lsodar8.\nA simulação será interrompida no momento em que as variáveis de estado estiverem a uma distância entre si menor que um parâmetro pré-definido (no exemplo, uma variação da ordem de 10-4). Assim, a função raiz calcula, em primeiro lugar, a taxa de variação e, depois, a diferença entre a soma dos valores absolutos e a tolerância definida:\n ### Critério de parada\rraiz \u0026lt;- function(tempo,incial,parametros) {\rvariacao \u0026lt;- unlist(solow_edo(tempo,incial,parametros)) # Desfaz lista\rsum(abs(variacao)) - 1e-4 # Tolerância\r}\r### Nova simulação do modelo, acrescida da raiz\rsolow_raiz \u0026lt;- lsodar(y = r,\rtimes = tempo,\rfunc = solow_edo,\rparms = parametros,\rrootfun = raiz) # Indicação da função criada\rtail(solow_raiz, n=3) # Compare com os três últimos sem parada\r## time r\r## [202,] 201.0000 2.901594\r## [203,] 202.0000 2.901698\r## [204,] 202.6914 2.901768\rPor fim, os gráficos estão na Figura 2.2. Note que a função matplot()9 foi usada para ter uma interface melhor adaptada à plotagem lado a lado e a lidar com mais de uma variável no mesmo gráfico. Nesta nota, serão dados exemplos também com a função plot(), da base do R.\npar(mfrow=c(1,2)) # Define gráficos a seguir em 1 linha e 2 colunas\r### Série original\rmatplot(x = solow[,1],\ry = solow[,2],\rtype = \u0026quot;l\u0026quot;, # Gráfico de linha\rlwd = 2, # Largura da linha\rcol = \u0026quot;red\u0026quot;,\rmain = \u0026quot;Modelo de Solow\u0026quot;,\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;r(t)\u0026quot;)\r### Série com interrupção\rmatplot(x = solow_raiz[,1], y = solow_raiz[,2],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;blue\u0026quot;,\rmain = \u0026quot;Modelo de Solow com parada\u0026quot;,\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;r(t)\u0026quot;)\r\rFigure 2.2: Elaboração própria.\r\r\r\r3 EDOs de 2a ordem\rEDOs de 2a ordem envolvem a segunda derivada da função principal. Vale notar que, para fins computacionais, EDOs de 2a ordem precisam ser escritas sob a forma de um sistema de equações de EDOs de 1a ordem10, bem como duas condições iniciais. Assim, uma EDO no formato\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39;\u0026#39; \u0026amp; = f(y,y\u0026#39;,t) \\\\\ry(t_0) \u0026amp; = y_{0}\\\\\ry\u0026#39;(t_0) \u0026amp; = y\u0026#39;_{0}\r\\end{split}\r\\tag{3.1}\r\\end{equation}\\] pode ser reescrita como\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39; \u0026amp; = y_1 \\\\\ry\u0026#39;\u0026#39; \u0026amp; = y\u0026#39;_{1} = f(y,y_1,t) \\\\\ry(t_0) \u0026amp; = y_{0}\\\\\ry_1(t_0) \u0026amp; = y\u0026#39;_{0}\r\\end{split}\r\\tag{3.2}\r\\end{equation}\\]\nA título de exemplo, pode-se simular o modelo de acelerador de segunda ordem exposto em Gandolfo (2005). A EDO do modelo é\r\\[\\begin{equation}\rK\u0026#39;\u0026#39; + \\beta K\u0026#39;+ \\alpha \\beta K = \\alpha \\beta K^*\r\\tag{3.3}\r\\end{equation}\\] em que \\(K\\) é o estoque corrente de capital, \\(K^*\\) é o estoque desejado de capital, \\(\\beta\\) denota a velocidade de ajuste do investimento real ao investimento desejado. Por fim, \\(\\alpha\\) é a velocidade de ajuste entre o estoque real e o desejado.\nÉ possível ampliar o sistema com \\(K^* = kY\\), em que \\(k\\) é a relação capital-produto e \\(Y\\) é o produto da economia. Assim, a equação (3.3) pode ser reescrita, após manipulações algébricas, como\r\\[\\begin{equation}\rK\u0026#39;\u0026#39; + \\beta \\left(1-\\frac{\\alpha k}{1 - b}\\right) K\u0026#39;+ \\alpha \\beta K = \\alpha \\beta k\\frac{a}{1 - b}\r\\tag{3.4}\r\\end{equation}\\] em que os termos \\(a\\) e \\(b\\) se referem a uma versão macroeconômica simples de uma função de consumo no formato \\(C = a + bY\\).\nA versão em sistema de EDOs de 1a ordem da equação (3.4) pode ser feita considerando \\(I = K\u0026#39;\\) o investimento e isolando as derivadas no lado esquerdo das equações:\r\\[\\begin{equation}\r\\begin{split}\rK\u0026#39; \u0026amp; = I \\\\\rI\u0026#39; \u0026amp; = -\\beta \\left(1-\\frac{\\alpha k}{1 - b}\\right) I - \\alpha \\beta K + \\alpha \\beta k\\frac{a}{1 - b}\\\\\rK(t_0) \u0026amp; = K_{0}\\\\\rK\u0026#39;(t_0) \u0026amp; = I\u0026#39;(t_0) = I_{0}\r\\end{split}\r\\tag{3.5}\r\\end{equation}\\]\nDiante disso, segue-se passos semelhantes à resolução de EDOs de 1a ordem. Em primeiro lugar, cria-se a função, agora com duas equações e duas saídas de dados.\n ### EDO do Acelerador de 2a ordem\racel_edo \u0026lt;- function(tempo, inicial, parametros){\rwith(as.list(c(inicial, parametros)),{\r# Equações apresentadas em (9)\rdK \u0026lt;- I\rdI \u0026lt;- -beta*(1-(alfa*k/(1-b)))*I - alfa*beta*K + alfa*beta*k*a/(1-b)\rlist(c(dK,dI)) # Retorna dois valores\r})\r}\rEm seguida, definem-se os parâmetros e o gráfico para representá-los na Figura 3.1.\ntempo \u0026lt;- seq(0,200, by = 0.5)\rinicial \u0026lt;- c(K = 1, I = 0)\rparametros \u0026lt;- c(alfa = 0.05,\rbeta = 0.25,\ra = 2,\rb = 0.8,\rk = 3)\r### Função semelhante à situação de 1a ordem\racel \u0026lt;- ode(y = inicial,\rtimes = tempo,\rfunc = acel_edo,\rparms = parametros)\r### Gráfico da EDO\rplot(x = acel[,\u0026quot;time\u0026quot;],\ry = acel[,\u0026quot;K\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;red\u0026quot;,\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;K(t)\u0026quot;,\rmain = TeX(\u0026quot;Acelerador de 2^a ordem\u0026quot;)) # Formato de texto LaTeX\rabline(h = 30, # Acrescenta linha tracejada para o equilíbrio\rlty = \u0026quot;dashed\u0026quot;) \r\rFigure 3.1: Elaboração própria.\r\rPor fim, note que as EDOs de ordem superiores podem ser resolvidas adotando uma combinação dos procedimentos explicitados acima.\n3.1 Equação com coeficientes constantes\rEquações com coeficientes constantes apresentam apenas a equação principal e suas derivadas variáveis no tempo. Um exemplo é a função \\(y\u0026#39;\u0026#39;(t) + 2y\u0026#39;(t) + y(t) = 0\\). Sua versão em sistema de EDOs de 1a ordem pode ser feita considerando \\(y_1(t) = y(t)\u0026#39;\\), isolando as derivadas no lado esquerdo das equações e adotando uma das soluções canônicas, conforme :\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39; \u0026amp; = y_1 \\\\\ry_1\u0026#39; \u0026amp; = -2y_1 - y\\\\\ry(0) \u0026amp; = 0\\\\\ry\u0026#39;(0) \u0026amp; = y_1 = 1\r\\end{split}\r\\tag{3.6}\r\\end{equation}\\]\nDiante disso, segue-se passos semelhantes à resolução de EDOs de 1a ordem. Em primeiro lugar, cria-se a função, agora com duas equações e duas saídas de dados. O gráfico está representado na Figura 3.2.\n ### EDO de equação de coeficientes constantes\rraizes_iguais \u0026lt;- function(t, inicial, parametros){\rwith(as.list(c(inicial, parametros)),{\r### Sistema de Equações representando EDO de 2a ordem\rdy \u0026lt;- y1\rdy1 \u0026lt;- -2*y1 - y\r### Resultados devem ser concatenados em uma lista\rlist(c(dy,dy1))\r})\r}\r### Tempo máximo reduzido, pois converge rapidamente\rtempo \u0026lt;- seq(1, 20, by = 0.1)\r### Condições iniciais canônicas\rinicial \u0026lt;- c(y = 0, y1 = 1)\r### EDO\rraizes_iguais_edo \u0026lt;- ode(y = inicial,\rtimes = tempo,\rfunc = raizes_iguais,\rparms = NULL) # Equação com parâmetros já definidos\r ### Gráfico da EDO com coeficientes constantes\rplot(raizes_iguais_edo[,\u0026quot;time\u0026quot;], raizes_iguais_edo[,\u0026quot;y\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;red\u0026quot;,\rxlab = \u0026quot;t\u0026quot;,\rylab = \u0026quot;y(t)\u0026quot;,\rmain = TeX(\u0026quot;$y\u0026#39;\u0026#39;(t) + 2y\u0026#39;(t) + y(t) = 0$\u0026quot;)) # Formato de texto LaTeX\r\rFigure 3.2: Coeficientes Constantes\r\r\r3.2 Equação de Laguerre\rA equação de Laguerre tem aplicabilidade na Física quântica e em outras áreas da Matemática e Física. Exemplos de aplicações estão em . Um dos exemplos está na versão do orbital s de um átomo de hidrogênio em seu menor nível de energia. A equação de Laguerre, nesse caso, é dada por \\(xy\u0026#39;\u0026#39;(x)+(1-x)y\u0026#39;(x) + y(x) = 0\\). Sua versão em sistema de EDOs de 1a ordem pode ser feita considerando \\(y_1(x) = y(x)\u0026#39;\\) e isolando as derivadas no lado esquerdo das equações e adotando uma das soluções canônicas:\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39; \u0026amp; = y_1 \\\\\ry_1\u0026#39; \u0026amp; = \\frac{-(1-x)}{x}y_1 - \\frac{y}{x}\\\\\ry(x_0) \u0026amp; = 0\\\\\ry\u0026#39;(x_0) \u0026amp; = y_1 = 1\r\\end{split}\r\\tag{3.7}\r\\end{equation}\\]\nDiante disso, segue-se passos semelhantes à resolução de EDOs de 1a ordem. Em primeiro lugar, cria-se a função, agora com duas equações e duas saídas de dados. O gráfico está representado na Figura 3.3.\n ### EDO de equação de Laguerre\rlaguerre \u0026lt;- function(x, inicial, parametros){\rwith(as.list(c(inicial, parametros)),{\r# Sistema de Equações representando EDO de 2a ordem\rdy \u0026lt;- y1\rdy1 \u0026lt;- -(1-x)/x*y1 - y/x\r# Resultados devem ser concatenados em uma lista\rlist(c(dy,dy1))\r})\r}\rx \u0026lt;- seq(1, 50, by = 0.1)\r### Condições iniciais canônicas\rinicial \u0026lt;- c(y = 0, y1 = 1)\r### EDO\rlaguerre_edo \u0026lt;- ode(y = inicial,\rtimes = x,\rfunc = laguerre,\rparms = NULL)\r ### Gráfico da EDO de Laguerre\rplot(laguerre_edo[,\u0026quot;time\u0026quot;], laguerre_edo[,\u0026quot;y\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;green\u0026quot;,\rxlab = \u0026quot;x\u0026quot;,\rylab = \u0026quot;y(x)\u0026quot;,\rmain = TeX(\u0026quot;$xy\u0026#39;\u0026#39;(x) + (1-x)y\u0026#39;(x) + y(x) = 0$\u0026quot;)) # Formato de texto LaTeX\r\rFigure 3.3: Equação de Laguerre\r\r\r3.3 Equação de Euler\rUm exemplo da chamada ``equação de Euler\" é dado pela função \\(t^2y\u0026#39;\u0026#39;(t) + 2ty\u0026#39;(t) - 2y(t) = t^5\\), conforme . Sua versão em sistema de EDOs de 1a ordem pode ser feita considerando \\(y_1(t) = y(t)\u0026#39;\\) e isolando as derivadas no lado esquerdo das equações e adotando uma das soluções canônicas, conforme:\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39; \u0026amp; = y_1 \\\\\ry_1\u0026#39; \u0026amp; = \\frac{-2y_1}{t} + \\frac{2y}{t^2} + t^3\\\\\ry(0) \u0026amp; = 1\\\\\ry\u0026#39;(0) \u0026amp; = y_1 = 0\r\\end{split}\r\\tag{3.8}\r\\end{equation}\\]\nDiante disso, segue-se passos semelhantes à resolução de EDOs de 1a ordem. Em primeiro lugar, cria-se a função, agora com duas equações e duas saídas de dados. O gráfico está representado na Figura 3.4.\n ### EDO de equação de Euler\reuler \u0026lt;- function(t, inicial, parametros){\rwith(as.list(c(inicial, parametros)),{\r# Sistema de Equações representando EDO de 2a ordem\rdy \u0026lt;- y1\rdy1 \u0026lt;- -2/t*y1 + 2*y/t**2 + t**3\r# Resultados devem ser concatenados em uma lista\rlist(c(dy,dy1))\r})\r}\rtempo \u0026lt;- seq(1,10, by = 0.2)\r### Condições iniciais canônicas\rinicial \u0026lt;- c(y = 1, y1 = 0)\r### EDO\reuler_edo \u0026lt;- ode(y = inicial,\rtimes = tempo,\rfunc = euler,\rparms = NULL)\r ### Gráfico da EDO com coeficientes constantes\rplot(euler_edo[,\u0026quot;time\u0026quot;],euler_edo[,\u0026quot;y\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;blue\u0026quot;,\rxlab = \u0026quot;t\u0026quot;,\rylab = \u0026quot;y(t)\u0026quot;,\rmain = TeX(\u0026quot;$t^2y\u0026#39;\u0026#39;(t) + 2ty\u0026#39;(t) - 2y(t) = t^5$ \u0026quot;)) # Formato de texto LaTeX\r\rFigure 3.4: Equação de Euler\r\r\r\r4 Equações diferenciais simultâneas\rO caso de um sistema com duas EDOs de 1a ordem pode ser resolvido de maneira semelhante ao modelo de 2a ordem apresentado na seção 3. Portanto, aqui será apresentada uma solução numérica para um sistema de três EDOs simultâneas trabalhado por Ma and Bangura (2012). Trata-se de um sistema econômico e financeiro que combina taxa de juro, de investimento e de inflação. Os detalhes do modelo devem ser avaliados no artigo original.\nO sistema fincaneiro (caótico) representado no modelo é tal que:\r\\[\\begin{equation}\r\\begin{split}\r\\dot{x} \u0026amp; = z + (y - a)x \\\\\r\\dot{y} \u0026amp; = 1 - by - x^2 \\\\\r\\dot{z} \u0026amp; = -x + cz\r\\end{split}\r\\tag{4.1}\r\\end{equation}\\] em que \\(x\\) expressa a taxa de juro, \\(y\\) representa a demanda por investimento e \\(z\\), o índice de preços. Ademais, \\(a \\geq 0\\) é o volume de poupança, \\(b \\geq 0\\) é o custo unitário do investimento e \\(c \\geq 0\\) é a elasticidade da demanda por bens.\nPara a simulação numérica, usam-se os seguintes valores iniciais e parâmetros sugeridos pelos autores: \\(x_0 = 0.03\\), \\(y_0 = 0.15\\), \\(z_0 = 0.25\\), \\(a = 5\\), \\(b = 0.15\\) e \\(c = 0\\). Com isso, a função é formada por:\n ### EDO do sistema financeiro caótico\rfinancial_edo \u0026lt;- function(tempo, inicial, parametros) {\rwith(as.list(c(inicial,parametros)),{\rdx \u0026lt;- z+(y - a)*x\rdy \u0026lt;- 1 - b*y - x^2\rdz \u0026lt;- -x - c*z\rlist(c(dx,dy,dz))\r})\r}\rO modelo pode com as três variáveis ser simulado na Figura 4.1 por meio do pacote scatterplot3d.\ntempo \u0026lt;- seq(0,100,by = .01)\rinicial \u0026lt;- c(x = .03,\ry = .15,\rz = .25)\rparametros \u0026lt;- c(a = 5,\rb = .15,\rc = .8)\r### EDO financial \u0026lt;- ode(y = inicial,\rtimes = tempo,\rfunc = financial_edo,\rparms = parametros)\r### Gráfico 3D de todo o sistema\rscatterplot3d(financial[,-1], # Exclui a coluna tempo para que apenas type = \u0026quot;l\u0026quot;, # as variáveis sejam representadas\rlwd = 3,\rxlab = \u0026quot;juro\u0026quot;,\rylab = \u0026quot;investimento\u0026quot;,\rzlab = \u0026quot;preços\u0026quot;)\r\rFigure 4.1: Elaboração própria.\r\rA partir da resolução de todo o sistema, pode-se avaliar apenas a relação entre duas variáveis como na Figura 4.2:\n ### Relação entre juro e demanda por investimento\rplot(x = financial[,\u0026quot;x\u0026quot;],\ry = financial[,\u0026quot;y\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 3,\rxlab = \u0026quot;juro\u0026quot;,\rylab = \u0026quot;investimento\u0026quot;)\r\rFigure 4.2: Elaboração própria.\r\rA relação entre inflação e juro está na Figura 4.3.\n # Relação entre juro e preço\rmatplot(x = financial[,\u0026quot;time\u0026quot;],\ry = financial[,c(\u0026quot;x\u0026quot;,\u0026quot;z\u0026quot;)],\rtype = \u0026quot;l\u0026quot;,\rlwd = 3,\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;\u0026quot;) # Exclui o título do eixo y\r### Legenda\rlegend(\u0026quot;bottomleft\u0026quot;, # Local no gráfico\rc(\u0026quot;juro\u0026quot;, \u0026quot;preços\u0026quot;), # Conteúdo da Legenda\rcol = 1:2, # Cores preto (1) e vermelho (2)\rlty = 1:2) # Linha contínua (1) e tracejada (2)\r\rFigure 4.3: Elaboração própria.\r\r\r5 Análise de estabilidade\rA análise de estabilidade com o pacote phaseR apresenta, de maneira gráfica, um diagrama de fase de uma EDO ou sistema de EDOs de modo a avaliar trajetórias iniciais distintas ou consequências de perturbações no modelo dinâmico.\nEste pacote depende de uma função que represente a EDO a partir da estrutura deSolve, vista nas seções anteriores. Os nomes dos parâmetros até agora foram adotados para que ficassem mais intuitivos. Entretanto, para o retrato de fase, os nomes dos parâmetros que aparecem na função da EDO devem ser os mesmos aceitos pelo próprio pacote deSolve conforme:\nO tempo deve ser representado pela letra t;\rOs valores iniciais devem estar contidos num vetor y; e\rOs parâmetros, indicados em um vetor parameters.\r\r5.1 Estabilidade de EDO de 1a ordem\rComo primeiro exemplo, tem-se a análise do modelo de Solow, apresentado na seção 2. Reorganizando os nomes da função e dos parâmetros, os comandos são:\n ### EDO com os nomes padrão dos parâmetros\rsolow_edo \u0026lt;- function(t,y,parameters){\rwith(as.list(c(y,parameters)),{\rr = y # Adaptação da notação do modelo\rdr = s*r^alpha - n*r\rlist(dr)\r})\r}\rt \u0026lt;- seq(0,300,1)\ry \u0026lt;- c(r = 1)\rparameters \u0026lt;- c(s= 0.1, alpha = 0.35, n=0.05)\rApós os ajustes na nomenclatura, é possível acrescentar o campo de fluxos (ou de velocidades) com a função flowField(). Ademais, pode-se simular algumas trajetórias com a função trajectory() a partir de pontos iniciais distintos conforme a Figura 5.1. O gráfico base deve conter o ajuste “add = FALSE.” Caso contrário, será adicionado a outro gráfico pré-existente, gerando problemas de configuração.\n ### Gráfico com o campo de fluxos\rflowField(solow_edo, # EDO\rxlim = c(0,300), # Limite para o eixo do tempo\rylim = c(0,4.1), # Limite para a variável em análise\rsystem = \u0026quot;one.dim\u0026quot;, # Apenas uma variável contra o tempo\rparameters = parameters, # Vetor numérico\radd = FALSE, # Se TRUE, adiciona campo a um gráfico anterior\rpoints = 15, # Densidade de setas (default = 21)\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;r(t)\u0026quot;,\rmain = \u0026quot;Estabilidade do Modelo de Solow\u0026quot;)\r### Desenho das trajetórias a partir de condições iniciais\rtrajectory(solow_edo,\ry0 = c(0, 0.5, 1.5, 2.5, 3, 3.5, 4), # diferentes pontos iniciais\rtlim = c(0, 300),\rsystem = \u0026quot;one.dim\u0026quot;,\rparameters = parameters,\rcol = \u0026quot;blue\u0026quot;)\r\rFigure 5.1: Elaboração própria.\r\r5.1.1 Retrato de fase\rPode-se também fazer o retrado de fase como na Figura 5.2, em que a variável em nível está representada no eixo horizontal e sua derivada no eixo vertical. Com isso, visualiza-se pontos de equilíbrio e suas estabilidades.\n ### Retrato de fase\rphasePortrait(solow_edo,\rylim = c(0, 4), # Limite da variável dependente\rsystem = \u0026quot;one.dim\u0026quot;,\rparameters = parameters,\rcol = \u0026quot;red\u0026quot;,\rxlab = \u0026quot;r(t)\u0026quot;,\rylab = TeX(\u0026quot;\\\\dot{r}(t)\u0026quot;),\rmain = \u0026quot;Retrato de Fase do Modelo de Solow\u0026quot;)\r\rFigure 5.2: Elaboração própria.\r\r\r\r5.2 Estabilidade de sistema de duas EDOs de 1a ordem - equilíbrio dinâmico\rProcedimentos semelhantes podem ser adotados para um sistema com duas equações. Para um exemplo de sistema homogêneo de EDOs cujo equilíbrio é estável, utiliza-se exemplo sugerido por Gandolfo (2005) no capítulo 18 (exercício 3), cuja esturutra é:\r\\[\\begin{equation}\r\\begin{split}\r\\dot{x} \u0026amp; = -2x + 4y \\\\\r\\dot{y} \u0026amp; = -x + y\r\\end{split}\r\\tag{5.1}\r\\end{equation}\\]\rAlém das informações disponíveis para o caso de uma variável (dimensão) apresentado acima, é possível desenhar as isolinhas nulas, que representam o formato geométrico onde a derivada de uma função é zero. Elas podem ser elaboradas com a função nullclines(). Note que, agora, os valores iniciais para a trajetória devem ser oferecidos em formato de matriz, representando os pares ordenados. O resultado pode ser visto na Figura 5.3.\n ### EDO do sistema\rgandolfo_edo_estavel \u0026lt;- function(t,y,parameters){\rx \u0026lt;- y[1] # Valores iniciais em formato de vetor\ry \u0026lt;- y[2] # e precisam ser renomeados\rdx \u0026lt;- -x-y\rdy \u0026lt;- 5*x-3*y list(c(dx,dy))\r}\r### Gráfico com o campo de fluxos\rflowField(gandolfo_edo_estavel,\rxlim = c(-5,5), # Limite da primeira variável\rylim = c(-5,5), # Limite da primeira variável\radd = FALSE,\rpoints = 15)\r### Isolhinhas nulas\rnullclines(gandolfo_edo_estavel, # EDO\rxlim = c(-5,5), # Limites compatíveis com o campo de fluxos\rylim = c(-5,5))\r### Matriz com as condições iniciais\ry0 \u0026lt;- matrix(c(0,3, # Pares ordenaos para y0\r0,-3,\r-5,0,\r4,-1),\rncol = 2,\rbyrow = TRUE) # Insere os dados numa matriz a partir das linhas\r### Desenho das trajetórias a partir de condições iniciais\rtrajectory(gandolfo_edo_estavel,\ry0 = y0,\rtlim = c(-5, 5))\r\rFigure 5.3: Elaboração própria.\r\r ### Matriz com as condições iniciais\ry0\r## [,1] [,2]\r## [1,] 0 3\r## [2,] 0 -3\r## [3,] -5 0\r## [4,] 4 -1\r\r5.3 Estabilidade de sistema de duas EDOs de 1a ordem - ponto de sela\rPara um exemplo de sistema de EDOs cujo equilíbrio é caracterizado por uma trajetória de sela, pode-se adotar o sistema homogêneo sugerido por Gandolfo (2005) no capítulo 18 ( exercício 1) cuja esturutra é:\r\\[\\begin{equation}\r\\begin{split}\r\\dot{x} \u0026amp; = -2x + 4y \\\\\r\\dot{y} \u0026amp; = -x + y\r\\end{split}\r\\tag{5.2}\r\\end{equation}\\]\rÉ possível perceber que se trata de uma trajetória de sela, cujas trajetórias estáveis e instáveis podem ser elaboradas com a função drawManifolds(). O resultado pode ser visto na Figura 5.4.\n ### EDO\rgandolfo_edo \u0026lt;- function(t,y,parameters){\rx \u0026lt;- y[1] # Valores iniciais em formato de vetor\ry \u0026lt;- y[2] # e precisam ser renomeados\rdx \u0026lt;- -2*x-4*y\rdy \u0026lt;- -x+y list(c(dx,dy))\r}\r### Campo de fluxos\rflowField(gandolfo_edo,\rxlim = c(-5,5),\rylim = c(-5,5),\radd = FALSE,\rpoints = 15)\r### Isolinhas\rnullclines(gandolfo_edo,\rxlim = c(-5,5),\rylim = c(-5,5))\r### Trajetórias de sela (instável e estável)\rdrawManifolds(gandolfo_edo,\ry0 = c(0, 0))\r### Matriz de choques iniciais\ry0 \u0026lt;- matrix(c(0,3,\r0,-3,\r-5,0,\r4,-1),\rncol = 2,\rbyrow = TRUE)\r### Trajetórias de choques\rtrajectory(gandolfo_edo,\ry0 = y0,\rtlim = c(-5, 5))\r\rFigure 5.4: Elaboração própria.\r\rEm linhas gerais, essas são as informações mais comuns na análise de sistemas dinâmicos no campo da Economia. Funções e tratamentos adicionais podem ser avaliados nos itens referenciados abaixo.\n\r\rReferências\rGandolfo, Giancarlo. 2005. Economic Dynamics. Study. New York - USA: Springer US.\r\rMa, Junhai, and Hamza I. Bangura. 2012. “Complexity analysis research of financial and economic system under the condition of three parameters’ change circumstances.” Nonlinear Dynamics 70 (4): 2313–26. https://doi.org/10.1007/s11071-012-0336-z.\r\rSeco, Lucas, and Mauro Patrão. 2018. Equações diferenciais ordinárias e séries de potências. Brasília - BRA: Editora Universidade de Brasília.\r\rSoetaert, Karline, Jeff Cash, and Francesca Mazzia. 2012. Use R ! Solving Differential Equations in R-Springer. Verlag Berlin Heidelberg: Springer.\r\rSoetaert, Karline, Thomas Petzoldt, and R. Woodrow Setzer. 2010. “Solving differential equations in R: Package deSolve.” Journal of Statistical Software 33 (9): 1–25. https://doi.org/10.18637/jss.v033.i09.\r\rSolow, Robert M. 1956. “A Contribution to the Theory of Economic Growth.” The Quaterly Journal of Economics 70 (1): 65–95. http://piketty.pse.ens.fr/files/Solow1956.pdf.\r\r\r\r\rDoutorando em Economia pela Universidade de Brasília. Pode ser contatado em rafaeldeacyprestemr@gmail.com.↩︎\n\rDoutor em Economia pela Universidade de Brasília. Pode ser contatado em theosantunes@gmail.com.↩︎\n\rProfessor Adjunto do Instituto de Economia e Relações Internacionais da Universidade Federal de Uberlândia (UFU)↩︎\n\r Alguns exemplos de representação gráfica podem ser vistos com a função example(deSolve).↩︎\n\r Para ver exemplos da função, clique aqui.↩︎\n\rO tempo demandado para a análise pode ser medido com as seguintes funções concatenadas: print(system.time(\u0026lt;código da função ode\u0026gt;)).↩︎\n\rOs detalhes do modelo podem ser consultados, pelo leitor, no artigo original e os artigos que o discutiram posteriormente.↩︎\n\rEsta é a operação padrão na própria função ode().↩︎\n\rEsta função desenha mais de uma coluna de uma matriz ao mesmo tempo. Com a função plot(), seriam necessários dois comandos.↩︎\n\rPara mais detalhes, ver Soetaert, Cash, and Mazzia (2012).↩︎\n\r\r\r","date":1618963200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1619002931,"objectID":"c059546241e44005ca794573ad1a5562","permalink":"/r-projetos/edos/","publishdate":"2021-04-21T00:00:00Z","relpermalink":"/r-projetos/edos/","section":"r-projetos","summary":"1 Introdução\r2 EDOs de 1a ordem\r\r2.1 Estrutura básica para simulação com R\r2.2 Interrupção automática da simulação\r\r3 EDOs de 2a ordem\r\r3.","tags":["R"],"title":"Simulaçao Numérica de EDOs","type":"r-projetos"},{"authors":[],"categories":[],"content":"\r\r\rIntrodução\rEDOs de 1a ordem\r\rEstrutura básica para simulação com R\rInterrupção automática da simulação\r\rEDOs de 2a ordem\r\rEquação com coeficientes constantes\rEquação de Laguerre\rEquação de Euler\r\rEquações diferenciais simultâneas\rAnálise de estabilidade\r\rEstabilidade de EDO de 1a ordem\r\rRetrato de fase\r\rEstabilidade de sistema de duas EDOs de 1a ordem - equilíbrio dinâmico\rEstabilidade de sistema de duas EDOs de 1a ordem - ponto de sela\r\rReferências\r\r\rRafael de Acypreste1, Theo Antunes2\nIntrodução\rO objetivo geral desta nota é realizar simulações numéricas de equações diferenciais ordinárias com ênfase, especialmente, em aplicações econômicas. Todas as simulações são feitas utilizando-se o software R.\nPara as simulações, serão utilizados os pacotes abaixo, adicionais à base do R. É preciso que sejam instalados (uma única vez) e carregados antes do uso:\n# install.packages(\u0026quot;deSolve\u0026quot;)\r# install.packages(\u0026quot;PhaseR\u0026quot;)\r# install.packages(\u0026quot;scatterplot3d\u0026quot;)\r# install.packages(\u0026quot;latex2exp\u0026quot;)\rlibrary(deSolve) # Funções para resolver EDOs\rlibrary(phaseR) # Funções para elaboração dos retratos de fase\rlibrary(scatterplot3d) # Gráficos em 3 dimensões\rlibrary(latex2exp) # Expressões escritas padrão LaTeX\roptions(scipen = 99) # Utiliza 99 casas decimais como padrão em vez de notação científica\rDenota-se por equação diferencial ordinária (EDO) uma função desconhecida e a relação com suas derivadas. Como, em economia, costuma-se usar o tempo como variável independente, esta notação permanecerá ao longo do texto se não estiver disposto de outra maneira. Portanto, pode-se representar uma EDO de ordem \\(n\\) por\n\\[\\begin{equation}\rf[y(t),y^{(1)}(t),y^{(2)}(t),...,y^{(n)}(t),t ] = 0\r\\tag{1}\r\\end{equation}\\]\nem que \\((n)\\) é o grau da EDO e representa a maior ordem das derivadas da função desconhecida Seco and Patrão (2018). Uma notação da forma geral pode ser descrita por:\n\\[\\begin{equation}\ra_n(t)y^{(n)}(t)+\\dots+a_2(t)y^{(2)}(t)+a_1(t)y^{(1)}(t)+a_0(t)y(t) = g(t) \\tag{2}\r\\end{equation}\\]\nNeste texto, não serão abordados detalhes teóricos sobre equações diferenciais e sobre os modelos apresentados. O(a) leitor(a) deve recorrer aos documentos citados em caso de interesse.\n\rEDOs de 1a ordem\rEDOs de 1a ordem envolvem uma equação em termos da sua primeira derivada \\(y\u0026#39;(t)\\). Conforme Gandolfo (2005), pode-se encontrar uma solução de uma equação homogênea no formato \\(y(t) = Ae^{-bt}\\), cuja estabilidade depende do sinal de \\(-b\\). Alguns exemplos de equações na Figura 1.\nApesar de servir de motivação para a análise de EDOs, o objetivo desta nota não é resolver EDOs, encontrando uma função \\(y(t)\\) que a satisfaz, mas sim identificar o comportamento de tais equações a partir de resoluções numéricas e representações gráficas. Portanto, passa-se aos detalhes básicos para as simulações.\n\rFigure 1: Elaboração própria.\r\rEstrutura básica para simulação com R\rAlgumas equações diferenciais apresentam soluções analíticas, que podem ser resolvidas a partir de técnicas específicas. Para a economia, uma boa referência é o livro do Gandolfo (2005). Para aplicações mais detalhadas, consultar Seco and Patrão (2018). Nesses casos, simples técnicas de elaboração de gráficos podem ser adotadas no R ou outro software.\nPorém, há situações que não se deseja ou não é simples encontrar uma solução analítica. Para esses casos, o R possui pacotes que ajudam a encontrar e representar graficamente soluções numéricas e retratos de fase, que podem ajudar na interpretação dos modelos.\nO pacote utilizado para simulação e resolução de EDOs com o R é o deSolve. Um espectro maior de aplicações e parte das explicações aqui apresentadas podem ser encontradas em Soetaert, Petzoldt, and Setzer (2010)}. Recursos adicionais e manuais podem ser acessados digitando ?deSolve diretamente no console3.\nEm primeiro lugar, deve-se definir uma função própria do modelo a ser simulado em linguagem própria do R com, no mínimo, os seguintes parâmetros nesta ordem:\nTempo para simulação;\rValor inicial das variáveis (estado); e\rParâmetros do modelo.\r\rQuando da resolução, o modelo chamará essa função em cada período de tempo durante o processo de integração. Tempo e valores iniciais devem ser disponibilizados no formato de vetores (ou listas). A função with( )4 permite usar as variáveis em formato de lista diretamente dentro da função sem que seja necessário indicar o nome da lista todas as vezes. Por fim, a função deve retornar uma lista (os resultados serão concatenados se estivermos interessados em mais de uma EDO). Os comandos estão detalhados abaixo.\nCom a função elaborada, são estabelecidos os nomes e valores dos parâmetros, a(s) condição(ões) inicial(is) e o período de tempo que se deseja fazer a simulação. Lembre-se de que, quanto maior o tempo e complexidade do modelo, maior será o nível de exigência computacional5.\nComo exemplo de EDO de 1a ordem, pode-se simular o seguinte modelo, baseado no modelo canônico de Solow (1956)6 representado na equação (3).\r\\[\\begin{equation}\r\\dot{r} = sF(r,1) - nr\r\\tag{3}\r\\end{equation}\\] em que \\(r = \\frac{K}{L}\\) é a razão capital-trabalho, \\(s\\) é a taxa de poupança, \\(n\\) é a taxa de crescimento da força de trabalho e \\(F(r,1)\\) é uma função de produção homogênea de grau um a ser especificada.\nNo presente caso, uma função Cobb-Douglas na forma \\(F(K,L) = K^\\alpha L^{1-\\alpha} \\Rightarrow F(r,1) = r^\\alpha\\) pode ser adotada para a resolução numérica. Portanto, a equação diferencial a ser simulada é:\r\\[\\begin{equation}\r\\dot{r} = sr^\\alpha - nr\r\\tag{4}\r\\end{equation}\\] cuja função para simuação da EDO pode ser construída por:\n ### Função em R que representa a EDO\rsolow_edo \u0026lt;- function(tempo, inicial, parametros){ # Parâmetros da função\rlist \u0026lt;- as.list(c(inicial, parametros)) # Lista c/ informações da EDO\rwith(list, { # with() acessa elementos da lista\rdr = s*r^alpha - n*r # EDO de interesse\rlist(dr) # Retorna valores simulados\r}) # Fim do with\r} # Fim da função\rA partir da função solow_edo criada, pode-se disponibilizar os dados específicos a partir da simulação com a função ode( ). Os valores dos parâmetros foram \\(s = 0.1\\), \\(\\alpha = 0.35\\) e \\(n = 0.05\\) e o valor inicial \\(r_0 = 1\\). Ao final, estão os três primeiros e últimos resultados:\n ### Valor inicial r \u0026lt;- c(r = 1) # Formato de vetor nominado de acordo com a função\r### Parâmetros da função (podem ser estimados)\rparametros \u0026lt;- c(s = 0.1,\ralpha = 0.35,\rn = 0.05) # Formato de vetor\r### Sequência de tempo\rtempo \u0026lt;- seq(0, 350, by = 1) ### Simulação do modelo solow \u0026lt;- ode(y = r, # Condição inicial\rtimes = tempo, # Tempo a ser simulado\rfunc = solow_edo, # Função criada\rparms = parametros) # Se parâmetros já definidos, use parms = NULL\r### Exibição dos resultados\rhead(solow, n=3) # Exibe três primeiros\r## time r\r## [1,] 0 1.000000\r## [2,] 1 1.049617\r## [3,] 2 1.098443\rtail(solow, n=3) # Exibe três últimos\r## time r\r## [349,] 348 2.904818\r## [350,] 349 2.904819\r## [351,] 350 2.904820\rO gráfico resultado do modelo está descrito na Figura 2, sob o título “Modelo de Solow.”\n\rInterrupção automática da simulação\rCaso o interesse seja só a fase inicial de uma equação ou se tenha uma EDO convergente, é possível usar a funcionalidade root da função lsodar7.\nA simulação será interrompida no momento em que as variáveis de estado estiverem a uma distância entre si menor que um parâmetro pré-definido (no exemplo, uma variação da ordem de 10-4). Assim, a função raiz calcula, em primeiro lugar, a taxa de variação e, depois, a diferença entre a soma dos valores absolutos e a tolerância definida:\n ### Critério de parada\rraiz \u0026lt;- function(tempo,incial,parametros) {\rvariacao \u0026lt;- unlist(solow_edo(tempo,incial,parametros)) # Desfaz lista\rsum(abs(variacao)) - 1e-4 # Tolerância\r}\r### Nova simulação do modelo, acrescida da raiz\rsolow_raiz \u0026lt;- lsodar(y = r,\rtimes = tempo,\rfunc = solow_edo,\rparms = parametros,\rrootfun = raiz) # Indicação da função criada\rtail(solow_raiz, n=3) # Compare com os três últimos sem parada\r## time r\r## [202,] 201.0000 2.901594\r## [203,] 202.0000 2.901698\r## [204,] 202.6914 2.901768\rPor fim, os gráficos estão na Figura 2. Note que a função matplot()8 foi usada para ter uma interface melhor adaptada à plotagem lado a lado e a lidar com mais de uma variável no mesmo gráfico. Nesta nota, serão dados exemplos também com a função plot(), da base do R.\npar(mfrow=c(1,2)) # Define gráficos a seguir em 1 linha e 2 colunas\r### Série original\rmatplot(x = solow[,1],\ry = solow[,2],\rtype = \u0026quot;l\u0026quot;, # Gráfico de linha\rlwd = 2, # Largura da linha\rcol = \u0026quot;red\u0026quot;,\rmain = \u0026quot;Modelo de Solow\u0026quot;,\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;r(t)\u0026quot;)\r### Série com interrupção\rmatplot(x = solow_raiz[,1], y = solow_raiz[,2],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;blue\u0026quot;,\rmain = \u0026quot;Modelo de Solow com parada\u0026quot;,\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;r(t)\u0026quot;)\r\rFigure 2: Elaboração própria.\r\r\r\rEDOs de 2a ordem\rEDOs de 2a ordem envolvem a segunda derivada da função principal. Vale notar que, para fins computacionais, EDOs de 2a ordem precisam ser escritas sob a forma de um sistema de equações de EDOs de 1a ordem9, bem como duas condições iniciais. Assim, uma EDO no formato\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39;\u0026#39; \u0026amp; = f(y,y\u0026#39;,t) \\\\\ry(t_0) \u0026amp; = y_{0}\\\\\ry\u0026#39;(t_0) \u0026amp; = y\u0026#39;_{0}\r\\end{split}\r\\tag{5}\r\\end{equation}\\] pode ser reescrita como\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39; \u0026amp; = y_1 \\\\\ry\u0026#39;\u0026#39; \u0026amp; = y\u0026#39;_{1} = f(y,y_1,t) \\\\\ry(t_0) \u0026amp; = y_{0}\\\\\ry_1(t_0) \u0026amp; = y\u0026#39;_{0}\r\\end{split}\r\\tag{6}\r\\end{equation}\\]\nA título de exemplo, pode-se simular o modelo de acelerador de segunda ordem exposto em Gandolfo (2005). A EDO do modelo é\r\\[\\begin{equation}\rK\u0026#39;\u0026#39; + \\beta K\u0026#39;+ \\alpha \\beta K = \\alpha \\beta K^*\r\\tag{7}\r\\end{equation}\\] em que \\(K\\) é o estoque corrente de capital, \\(K^*\\) é o estoque desejado de capital, \\(\\beta\\) denota a velocidade de ajuste do investimento real ao investimento desejado. Por fim, \\(\\alpha\\) é a velocidade de ajuste entre o estoque real e o desejado.\nÉ possível ampliar o sistema com \\(K^* = kY\\), em que \\(k\\) é a relação capital-produto e \\(Y\\) é o produto da economia. Assim, a equação (7) pode ser reescrita, após manipulações algébricas, como\r\\[\\begin{equation}\rK\u0026#39;\u0026#39; + \\beta \\left(1-\\frac{\\alpha k}{1 - b}\\right) K\u0026#39;+ \\alpha \\beta K = \\alpha \\beta k\\frac{a}{1 - b}\r\\tag{8}\r\\end{equation}\\] em que os termos \\(a\\) e \\(b\\) se referem a uma versão macroeconômica simples de uma função de consumo no formato \\(C = a + bY\\).\nA versão em sistema de EDOs de 1a ordem da equação (8) pode ser feita considerando \\(I = K\u0026#39;\\) o investimento e isolando as derivadas no lado esquerdo das equações:\r\\[\\begin{equation}\r\\begin{split}\rK\u0026#39; \u0026amp; = I \\\\\rI\u0026#39; \u0026amp; = -\\beta \\left(1-\\frac{\\alpha k}{1 - b}\\right) I - \\alpha \\beta K + \\alpha \\beta k\\frac{a}{1 - b}\\\\\rK(t_0) \u0026amp; = K_{0}\\\\\rK\u0026#39;(t_0) \u0026amp; = I\u0026#39;(t_0) = I_{0}\r\\end{split}\r\\tag{9}\r\\end{equation}\\]\nDiante disso, segue-se passos semelhantes à resolução de EDOs de 1a ordem. Em primeiro lugar, cria-se a função, agora com duas equações e duas saídas de dados.\n ### EDO do Acelerador de 2a ordem\racel_edo \u0026lt;- function(tempo, inicial, parametros){\rwith(as.list(c(inicial, parametros)),{\r# Equações apresentadas em (9)\rdK \u0026lt;- I\rdI \u0026lt;- -beta*(1-(alfa*k/(1-b)))*I - alfa*beta*K + alfa*beta*k*a/(1-b)\rlist(c(dK,dI)) # Retorna dois valores\r})\r}\rEm seguida, definem-se os parâmetros e o gráfico para representá-los na Figura 3.\ntempo \u0026lt;- seq(0,200, by = 0.5)\rinicial \u0026lt;- c(K = 1, I = 0)\rparametros \u0026lt;- c(alfa = 0.05,\rbeta = 0.25,\ra = 2,\rb = 0.8,\rk = 3)\r### Função semelhante à situação de 1a ordem\racel \u0026lt;- ode(y = inicial,\rtimes = tempo,\rfunc = acel_edo,\rparms = parametros)\r### Gráfico da EDO\rplot(x = acel[,\u0026quot;time\u0026quot;],\ry = acel[,\u0026quot;K\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;red\u0026quot;,\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;K(t)\u0026quot;,\rmain = TeX(\u0026quot;Acelerador de 2^a ordem\u0026quot;)) # Formato de texto LaTeX\rabline(h = 30, # Acrescenta linha tracejada para o equilíbrio\rlty = \u0026quot;dashed\u0026quot;) \r\rFigure 3: Elaboração própria.\r\rPor fim, note que as EDOs de ordem superiores podem ser resolvidas adotando uma combinação dos procedimentos explicitados acima.\nEquação com coeficientes constantes\rEquações com coeficientes constantes apresentam apenas a equação principal e suas derivadas variáveis no tempo. Um exemplo é a função \\(y\u0026#39;\u0026#39;(t) + 2y\u0026#39;(t) + y(t) = 0\\). Sua versão em sistema de EDOs de 1a ordem pode ser feita considerando \\(y_1(t) = y(t)\u0026#39;\\), isolando as derivadas no lado esquerdo das equações e adotando uma das soluções canônicas, conforme :\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39; \u0026amp; = y_1 \\\\\ry_1\u0026#39; \u0026amp; = -2y_1 - y\\\\\ry(0) \u0026amp; = 0\\\\\ry\u0026#39;(0) \u0026amp; = y_1 = 1\r\\end{split}\r\\tag{10}\r\\end{equation}\\]\nDiante disso, segue-se passos semelhantes à resolução de EDOs de 1a ordem. Em primeiro lugar, cria-se a função, agora com duas equações e duas saídas de dados. O gráfico está representado na Figura 4.\n ### EDO de equação de coeficientes constantes\rraizes_iguais \u0026lt;- function(t, inicial, parametros){\rwith(as.list(c(inicial, parametros)),{\r### Sistema de Equações representando EDO de 2a ordem\rdy \u0026lt;- y1\rdy1 \u0026lt;- -2*y1 - y\r### Resultados devem ser concatenados em uma lista\rlist(c(dy,dy1))\r})\r}\r### Tempo máximo reduzido, pois converge rapidamente\rtempo \u0026lt;- seq(1, 20, by = 0.1)\r### Condições iniciais canônicas\rinicial \u0026lt;- c(y = 0, y1 = 1)\r### EDO\rraizes_iguais_edo \u0026lt;- ode(y = inicial,\rtimes = tempo,\rfunc = raizes_iguais,\rparms = NULL) # Equação com parâmetros já definidos\r ### Gráfico da EDO com coeficientes constantes\rplot(raizes_iguais_edo[,\u0026quot;time\u0026quot;], raizes_iguais_edo[,\u0026quot;y\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;red\u0026quot;,\rxlab = \u0026quot;t\u0026quot;,\rylab = \u0026quot;y(t)\u0026quot;,\rmain = TeX(\u0026quot;$y\u0026#39;\u0026#39;(t) + 2y\u0026#39;(t) + y(t) = 0$\u0026quot;)) # Formato de texto LaTeX\r\rFigure 4: Coeficientes Constantes\r\r\rEquação de Laguerre\rA equação de Laguerre tem aplicabilidade na Física quântica e em outras áreas da Matemática e Física. Exemplos de aplicações estão em . Um dos exemplos está na versão do orbital s de um átomo de hidrogênio em seu menor nível de energia. A equação de Laguerre, nesse caso, é dada por \\(xy\u0026#39;\u0026#39;(x)+(1-x)y\u0026#39;(x) + y(x) = 0\\). Sua versão em sistema de EDOs de 1a ordem pode ser feita considerando \\(y_1(x) = y(x)\u0026#39;\\) e isolando as derivadas no lado esquerdo das equações e adotando uma das soluções canônicas:\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39; \u0026amp; = y_1 \\\\\ry_1\u0026#39; \u0026amp; = \\frac{-(1-x)}{x}y_1 - \\frac{y}{x}\\\\\ry(x_0) \u0026amp; = 0\\\\\ry\u0026#39;(x_0) \u0026amp; = y_1 = 1\r\\end{split}\r\\tag{11}\r\\end{equation}\\]\nDiante disso, segue-se passos semelhantes à resolução de EDOs de 1a ordem. Em primeiro lugar, cria-se a função, agora com duas equações e duas saídas de dados. O gráfico está representado na Figura 5.\n ### EDO de equação de Laguerre\rlaguerre \u0026lt;- function(x, inicial, parametros){\rwith(as.list(c(inicial, parametros)),{\r# Sistema de Equações representando EDO de 2a ordem\rdy \u0026lt;- y1\rdy1 \u0026lt;- -(1-x)/x*y1 - y/x\r# Resultados devem ser concatenados em uma lista\rlist(c(dy,dy1))\r})\r}\rx \u0026lt;- seq(1, 50, by = 0.1)\r### Condições iniciais canônicas\rinicial \u0026lt;- c(y = 0, y1 = 1)\r### EDO\rlaguerre_edo \u0026lt;- ode(y = inicial,\rtimes = x,\rfunc = laguerre,\rparms = NULL)\r ### Gráfico da EDO de Laguerre\rplot(laguerre_edo[,\u0026quot;time\u0026quot;], laguerre_edo[,\u0026quot;y\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;green\u0026quot;,\rxlab = \u0026quot;x\u0026quot;,\rylab = \u0026quot;y(x)\u0026quot;,\rmain = TeX(\u0026quot;$xy\u0026#39;\u0026#39;(x) + (1-x)y\u0026#39;(x) + y(x) = 0$\u0026quot;)) # Formato de texto LaTeX\r\rFigure 5: Equação de Laguerre\r\r\rEquação de Euler\rUm exemplo da chamada ``equação de Euler\" é dado pela função \\(t^2y\u0026#39;\u0026#39;(t) + 2ty\u0026#39;(t) - 2y(t) = t^5\\), conforme . Sua versão em sistema de EDOs de 1a ordem pode ser feita considerando \\(y_1(t) = y(t)\u0026#39;\\) e isolando as derivadas no lado esquerdo das equações e adotando uma das soluções canônicas, conforme:\r\\[\\begin{equation}\r\\begin{split}\ry\u0026#39; \u0026amp; = y_1 \\\\\ry_1\u0026#39; \u0026amp; = \\frac{-2y_1}{t} + \\frac{2y}{t^2} + t^3\\\\\ry(0) \u0026amp; = 1\\\\\ry\u0026#39;(0) \u0026amp; = y_1 = 0\r\\end{split}\r\\tag{12}\r\\end{equation}\\]\nDiante disso, segue-se passos semelhantes à resolução de EDOs de 1a ordem. Em primeiro lugar, cria-se a função, agora com duas equações e duas saídas de dados. O gráfico está representado na Figura 6.\n ### EDO de equação de Euler\reuler \u0026lt;- function(t, inicial, parametros){\rwith(as.list(c(inicial, parametros)),{\r# Sistema de Equações representando EDO de 2a ordem\rdy \u0026lt;- y1\rdy1 \u0026lt;- -2/t*y1 + 2*y/t**2 + t**3\r# Resultados devem ser concatenados em uma lista\rlist(c(dy,dy1))\r})\r}\rtempo \u0026lt;- seq(1,10, by = 0.2)\r### Condições iniciais canônicas\rinicial \u0026lt;- c(y = 1, y1 = 0)\r### EDO\reuler_edo \u0026lt;- ode(y = inicial,\rtimes = tempo,\rfunc = euler,\rparms = NULL)\r ### Gráfico da EDO com coeficientes constantes\rplot(euler_edo[,\u0026quot;time\u0026quot;],euler_edo[,\u0026quot;y\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 2,\rcol = \u0026quot;blue\u0026quot;,\rxlab = \u0026quot;t\u0026quot;,\rylab = \u0026quot;y(t)\u0026quot;,\rmain = TeX(\u0026quot;$t^2y\u0026#39;\u0026#39;(t) + 2ty\u0026#39;(t) - 2y(t) = t^5$ \u0026quot;)) # Formato de texto LaTeX\r\rFigure 6: Equação de Euler\r\r\r\rEquações diferenciais simultâneas\rO caso de um sistema com duas EDOs de 1a ordem pode ser resolvido de maneira semelhante ao modelo de 2a ordem apresentado na seção ??. Portanto, aqui será apresentada uma solução numérica para um sistema de três EDOs simultâneas trabalhado por Ma and Bangura (2012). Trata-se de um sistema econômico e financeiro que combina taxa de juro, de investimento e de inflação. Os detalhes do modelo devem ser avaliados no artigo original.\nO sistema fincaneiro (caótico) representado no modelo é tal que:\r\\[\\begin{equation}\r\\begin{split}\r\\dot{x} \u0026amp; = z + (y - a)x \\\\\r\\dot{y} \u0026amp; = 1 - by - x^2 \\\\\r\\dot{z} \u0026amp; = -x + cz\r\\end{split}\r\\tag{13}\r\\end{equation}\\] em que \\(x\\) expressa a taxa de juro, \\(y\\) representa a demanda por investimento e \\(z\\), o índice de preços. Ademais, \\(a \\geq 0\\) é o volume de poupança, \\(b \\geq 0\\) é o custo unitário do investimento e \\(c \\geq 0\\) é a elasticidade da demanda por bens.\nPara a simulação numérica, usam-se os seguintes valores iniciais e parâmetros sugeridos pelos autores: \\(x_0 = 0.03\\), \\(y_0 = 0.15\\), \\(z_0 = 0.25\\), \\(a = 5\\), \\(b = 0.15\\) e \\(c = 0\\). Com isso, a função é formada por:\n ### EDO do sistema financeiro caótico\rfinancial_edo \u0026lt;- function(tempo, inicial, parametros) {\rwith(as.list(c(inicial,parametros)),{\rdx \u0026lt;- z+(y - a)*x\rdy \u0026lt;- 1 - b*y - x^2\rdz \u0026lt;- -x - c*z\rlist(c(dx,dy,dz))\r})\r}\rO modelo pode com as três variáveis ser simulado na Figura 7 por meio do pacote scatterplot3d.\ntempo \u0026lt;- seq(0,100,by = .01)\rinicial \u0026lt;- c(x = .03,\ry = .15,\rz = .25)\rparametros \u0026lt;- c(a = 5,\rb = .15,\rc = .8)\r### EDO financial \u0026lt;- ode(y = inicial,\rtimes = tempo,\rfunc = financial_edo,\rparms = parametros)\r### Gráfico 3D de todo o sistema\rscatterplot3d(financial[,-1], # Exclui a coluna tempo para que apenas type = \u0026quot;l\u0026quot;, # as variáveis sejam representadas\rlwd = 3,\rxlab = \u0026quot;juro\u0026quot;,\rylab = \u0026quot;investimento\u0026quot;,\rzlab = \u0026quot;preços\u0026quot;)\r\rFigure 7: Elaboração própria.\r\rA partir da resolução de todo o sistema, pode-se avaliar apenas a relação entre duas variáveis como na Figura 8:\n ### Relação entre juro e demanda por investimento\rplot(x = financial[,\u0026quot;x\u0026quot;],\ry = financial[,\u0026quot;y\u0026quot;],\rtype = \u0026quot;l\u0026quot;,\rlwd = 3,\rxlab = \u0026quot;juro\u0026quot;,\rylab = \u0026quot;investimento\u0026quot;)\r\rFigure 8: Elaboração própria.\r\rA relação entre inflação e juro está na Figura 9.\n # Relação entre juro e preço\rmatplot(x = financial[,\u0026quot;time\u0026quot;],\ry = financial[,c(\u0026quot;x\u0026quot;,\u0026quot;z\u0026quot;)],\rtype = \u0026quot;l\u0026quot;,\rlwd = 3,\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;\u0026quot;) # Exclui o título do eixo y\r### Legenda\rlegend(\u0026quot;bottomleft\u0026quot;, # Local no gráfico\rc(\u0026quot;juro\u0026quot;, \u0026quot;preços\u0026quot;), # Conteúdo da Legenda\rcol = 1:2, # Cores preto (1) e vermelho (2)\rlty = 1:2) # Linha contínua (1) e tracejada (2)\r\rFigure 9: Elaboração própria.\r\r\rAnálise de estabilidade\rA análise de estabilidade com o pacote phaseR apresenta, de maneira gráfica, um diagrama de fase de uma EDO ou sistema de EDOs de modo a avaliar trajetórias iniciais distintas ou consequências de perturbações no modelo dinâmico.\nEste pacote depende de uma função que represente a EDO a partir da estrutura deSolve, vista nas seções anteriores. Os nomes dos parâmetros até agora foram adotados para que ficassem mais intuitivos. Entretanto, para o retrato de fase, os nomes dos parâmetros que aparecem na função da EDO devem ser os mesmos aceitos pelo próprio pacote deSolve conforme:\nO tempo deve ser representado pela letra t;\rOs valores iniciais devem estar contidos num vetor y; e\rOs parâmetros, indicados em um vetor parameters.\r\rEstabilidade de EDO de 1a ordem\rComo primeiro exemplo, tem-se a análise do modelo de Solow, apresentado na seção ??. Reorganizando os nomes da função e dos parâmetros, os comandos são:\n ### EDO com os nomes padrão dos parâmetros\rsolow_edo \u0026lt;- function(t,y,parameters){\rwith(as.list(c(y,parameters)),{\rr = y # Adaptação da notação do modelo\rdr = s*r^alpha - n*r\rlist(dr)\r})\r}\rt \u0026lt;- seq(0,300,1)\ry \u0026lt;- c(r = 1)\rparameters \u0026lt;- c(s= 0.1, alpha = 0.35, n=0.05)\rApós os ajustes na nomenclatura, é possível acrescentar o campo de fluxos (ou de velocidades) com a função flowField(). Ademais, pode-se simular algumas trajetórias com a função trajectory() a partir de pontos iniciais distintos conforme a Figura 10. O gráfico base deve conter o ajuste “add = FALSE.” Caso contrário, será adicionado a outro gráfico pré-existente, gerando problemas de configuração.\n ### Gráfico com o campo de fluxos\rflowField(solow_edo, # EDO\rxlim = c(0,300), # Limite para o eixo do tempo\rylim = c(0,4.1), # Limite para a variável em análise\rsystem = \u0026quot;one.dim\u0026quot;, # Apenas uma variável contra o tempo\rparameters = parameters, # Vetor numérico\radd = FALSE, # Se TRUE, adiciona campo a um gráfico anterior\rpoints = 15, # Densidade de setas (default = 21)\rxlab = \u0026quot;tempo\u0026quot;,\rylab = \u0026quot;r(t)\u0026quot;,\rmain = \u0026quot;Estabilidade do Modelo de Solow\u0026quot;)\r### Desenho das trajetórias a partir de condições iniciais\rtrajectory(solow_edo,\ry0 = c(0, 0.5, 1.5, 2.5, 3, 3.5, 4), # diferentes pontos iniciais\rtlim = c(0, 300),\rsystem = \u0026quot;one.dim\u0026quot;,\rparameters = parameters,\rcol = \u0026quot;blue\u0026quot;)\r\rFigure 10: Elaboração própria.\r\rRetrato de fase\rPode-se também fazer o retrado de fase como na Figura 11, em que a variável em nível está representada no eixo horizontal e sua derivada no eixo vertical. Com isso, visualiza-se pontos de equilíbrio e suas estabilidades.\n ### Retrato de fase\rphasePortrait(solow_edo,\rylim = c(0, 4), # Limite da variável dependente\rsystem = \u0026quot;one.dim\u0026quot;,\rparameters = parameters,\rcol = \u0026quot;red\u0026quot;,\rxlab = \u0026quot;r(t)\u0026quot;,\rylab = TeX(\u0026quot;\\\\dot{r}(t)\u0026quot;),\rmain = \u0026quot;Retrato de Fase do Modelo de Solow\u0026quot;)\r\rFigure 11: Elaboração própria.\r\r\r\rEstabilidade de sistema de duas EDOs de 1a ordem - equilíbrio dinâmico\rProcedimentos semelhantes podem ser adotados para um sistema com duas equações. Para um exemplo de sistema homogêneo de EDOs cujo equilíbrio é estável, utiliza-se exemplo sugerido por Gandolfo (2005) no capítulo 18 (exercício 3), cuja esturutra é:\r\\[\\begin{equation}\r\\begin{split}\r\\dot{x} \u0026amp; = -2x + 4y \\\\\r\\dot{y} \u0026amp; = -x + y\r\\end{split}\r\\tag{14}\r\\end{equation}\\]\rAlém das informações disponíveis para o caso de uma variável (dimensão) apresentado acima, é possível desenhar as isolinhas nulas, que representam o formato geométrico onde a derivada de uma função é zero. Elas podem ser elaboradas com a função nullclines(). Note que, agora, os valores iniciais para a trajetória devem ser oferecidos em formato de matriz, representando os pares ordenados. O resultado pode ser visto na Figura 12.\n ### EDO do sistema\rgandolfo_edo_estavel \u0026lt;- function(t,y,parameters){\rx \u0026lt;- y[1] # Valores iniciais em formato de vetor\ry \u0026lt;- y[2] # e precisam ser renomeados\rdx \u0026lt;- -x-y\rdy \u0026lt;- 5*x-3*y list(c(dx,dy))\r}\r### Gráfico com o campo de fluxos\rflowField(gandolfo_edo_estavel,\rxlim = c(-5,5), # Limite da primeira variável\rylim = c(-5,5), # Limite da primeira variável\radd = FALSE,\rpoints = 15)\r### Isolhinhas nulas\rnullclines(gandolfo_edo_estavel, # EDO\rxlim = c(-5,5), # Limites compatíveis com o campo de fluxos\rylim = c(-5,5))\r### Matriz com as condições iniciais\ry0 \u0026lt;- matrix(c(0,3, # Pares ordenaos para y0\r0,-3,\r-5,0,\r4,-1),\rncol = 2,\rbyrow = TRUE) # Insere os dados numa matriz a partir das linhas\r### Desenho das trajetórias a partir de condições iniciais\rtrajectory(gandolfo_edo_estavel,\ry0 = y0,\rtlim = c(-5, 5))\r\rFigure 12: Elaboração própria.\r\r ### Matriz com as condições iniciais\ry0\r## [,1] [,2]\r## [1,] 0 3\r## [2,] 0 -3\r## [3,] -5 0\r## [4,] 4 -1\r\rEstabilidade de sistema de duas EDOs de 1a ordem - ponto de sela\rPara um exemplo de sistema de EDOs cujo equilíbrio é caracterizado por uma trajetória de sela, pode-se adotar o sistema homogêneo sugerido por Gandolfo (2005) no capítulo 18 ( exercício 1) cuja esturutra é:\r\\[\\begin{equation}\r\\begin{split}\r\\dot{x} \u0026amp; = -2x + 4y \\\\\r\\dot{y} \u0026amp; = -x + y\r\\end{split}\r\\tag{15}\r\\end{equation}\\]\rÉ possível perceber que se trata de uma trajetória de sela, cujas trajetórias estáveis e instáveis podem ser elaboradas com a função drawManifolds(). O resultado pode ser visto na Figura 13.\n ### EDO\rgandolfo_edo \u0026lt;- function(t,y,parameters){\rx \u0026lt;- y[1] # Valores iniciais em formato de vetor\ry \u0026lt;- y[2] # e precisam ser renomeados\rdx \u0026lt;- -2*x-4*y\rdy \u0026lt;- -x+y list(c(dx,dy))\r}\r### Campo de fluxos\rflowField(gandolfo_edo,\rxlim = c(-5,5),\rylim = c(-5,5),\radd = FALSE,\rpoints = 15)\r### Isolinhas\rnullclines(gandolfo_edo,\rxlim = c(-5,5),\rylim = c(-5,5))\r### Trajetórias de sela (instável e estável)\rdrawManifolds(gandolfo_edo,\ry0 = c(0, 0))\r### Matriz de choques iniciais\ry0 \u0026lt;- matrix(c(0,3,\r0,-3,\r-5,0,\r4,-1),\rncol = 2,\rbyrow = TRUE)\r### Trajetórias de choques\rtrajectory(gandolfo_edo,\ry0 = y0,\rtlim = c(-5, 5))\r\rFigure 13: Elaboração própria.\r\rEm linhas gerais, essas são as informações mais comuns na análise de sistemas dinâmicos no campo da Economia. Funções e tratamentos adicionais podem ser avaliados nos itens referenciados abaixo.\n\r\rReferências\rGandolfo, Giancarlo. 2005. Economic Dynamics. Study. New York - USA: Springer US.\r\rMa, Junhai, and Hamza I. Bangura. 2012. “Complexity analysis research of financial and economic system under the condition of three parameters’ change circumstances.” Nonlinear Dynamics 70 (4): 2313–26. https://doi.org/10.1007/s11071-012-0336-z.\r\rSeco, Lucas, and Mauro Patrão. 2018. Equações diferenciais ordinárias e séries de potências. Brasília - BRA: Editora Universidade de Brasília.\r\rSoetaert, Karline, Jeff Cash, and Francesca Mazzia. 2012. Use R ! Solving Differential Equations in R-Springer. Verlag Berlin Heidelberg: Springer.\r\rSoetaert, Karline, Thomas Petzoldt, and R. Woodrow Setzer. 2010. “Solving differential equations in R: Package deSolve.” Journal of Statistical Software 33 (9): 1–25. https://doi.org/10.18637/jss.v033.i09.\r\rSolow, Robert M. 1956. “A Contribution to the Theory of Economic Growth.” The Quaterly Journal of Economics 70 (1): 65–95. http://piketty.pse.ens.fr/files/Solow1956.pdf.\r\r\r\r\rDoutorando em Economia pela Universidade de Brasília. Pode ser contatado em rafaeldeacyprestemr@gmail.com.↩︎\n\rDoutor em Economia pela Universidade de Brasília. Pode ser contatado em theosantunes@gmail.com.↩︎\n\r Alguns exemplos de representação gráfica podem ser vistos com a função example(deSolve).↩︎\n\r Para ver exemplos da função, clique aqui.↩︎\n\rO tempo demandado para a análise pode ser medido com as seguintes funções concatenadas: print(system.time(\u0026lt;código da função ode\u0026gt;)).↩︎\n\rOs detalhes do modelo podem ser consultados, pelo leitor, no artigo original e os artigos que o discutiram posteriormente.↩︎\n\rEsta é a operação padrão na própria função ode().↩︎\n\rEsta função desenha mais de uma coluna de uma matriz ao mesmo tempo. Com a função plot(), seriam necessários dois comandos.↩︎\n\rPara mais detalhes, ver Soetaert, Cash, and Mazzia (2012).↩︎\n\r\r\r","date":1618876800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618918833,"objectID":"e70aebdb5662627813aac05d4f6736a0","permalink":"/project/edos/","publishdate":"2021-04-20T00:00:00Z","relpermalink":"/project/edos/","section":"project","summary":"Introdução\rEDOs de 1a ordem\r\rEstrutura básica para simulação com R\rInterrupção automática da simulação\r\rEDOs de 2a ordem\r\rEquação com coeficientes constantes\rEquação de Laguerre\rEquação de Euler\r\rEquações diferenciais simultâneas\rAnálise de estabilidade\r\rEstabilidade de EDO de 1a ordem\r\rRetrato de fase\r\rEstabilidade de sistema de duas EDOs de 1a ordem - equilíbrio dinâmico\rEstabilidade de sistema de duas EDOs de 1a ordem - ponto de sela\r\rReferências\r\r\rRafael de Acypreste1, Theo Antunes2","tags":[],"title":"EDOs","type":"project"},{"authors":[],"categories":[],"content":"\r\rIntrodução\rApresentar informações estatísticas por meio de gráficos pode ser uma ferramenta importante para melhorar o entendimento de informações complexas. Para isso, deve-se elaborar um gráfico eficiente. Uma forma é mais eficiente que a outra se sua informação pode ser decodificada pela maioria dos leitores de forma mais rápida ou mais fácil de acordo com Robbins (2004). Portanto, cuidados são necessários para que os gráficos não sejam ineficientes, confusos ou transmitam informações erradas.\nEsta nota tem por objetivo apresentar o material utilizado e as rotinas realizadas para a apresentação de dados estatísticos econômicos com o pacote ggplot2. Esse pacote permite apresentar dados seguindo uma “gramática de gráficos,” que “makes ggplot2 very powerful because you are not limited to a set of pre-specified graphics, but you can create new graphics that are precisely tailored for your problem,” conforme Wickham (2015).\nEm síntese, Wickham (2015) explica essa gramática de gráficos como uma representação estatística que mapeia informações em atributos estéticos (cores, formatos, tamanhos) de objetos geométricos (pontos, linhas, barras) em um sistema específico de coordenadas. Diferentes facetas podem ser usadas para representar, numa única imagem, diferentes subconjuntos de uma tabela. E é a combinação desses elementos que forma um gráfico.\nDo ponto de vista mais concreto, em primeiro lugar, é necessário instalar (uma única vez) e carregar os pacotes abaixo para realizar as rotinas no R1.\n# install.packages(\u0026quot;tidyverse\u0026quot;) Instala o pacote tidyverse, por exemplo\rlibrary(tidyverse) # Organização das tabelas e elaboração de gráficos\rlibrary(RColorBrewer) # Paletas de cores para os gráficos\rlibrary(viridis) # Paletas de cores para os gráficos\rlibrary(ggthemes) # Interfaces gráficas adicionais\rlibrary(scales) # Ajuste de escala dos gráficos\rlibrary(lubridate) # Ferramenta para ajuste de datas\rlibrary(zoo) # Ferramenta também para ajuste de datas\rlibrary(sidrar) # Acessar dados do IBGE\r#library(rbcb) # Acessar dados do BCB\roptions(scipen = 999)\rUm bom processo de elaboração de gráficos exige que sua matéria prima esteja no formato ideal, com as tabelas devidamente organizadas. Esse processo de organização leva à chamada ``tidy data’’ (por isso o nome do primeiro pacote utilizado), conforme Wickham (2014). Em síntese, os dados devem ser organizados de duas formas. Cada valor (cada célula numa tabela do Excel, por exemplo) pertence a uma variável e a uma observação. Variável contém valores que se referem a uma mesma característica ou atributo — podemos citar como exemplos a data, o valor da taxa de inflação ou da taxa de desocupação e etc. — e são representadas por colunas. Cada observação, isto é, cada linha contém todos os valores medidos sobre uma mesma unidade, como uma região e um trimestre.\n\rCompontentes básicos dos gráficos\rTodos os gráficos feitos com o ggplot2 têm seis componentes básicos:\nInformações (tabela);\rMapeamentos estéticos (variáveis e outras propriedades visuais);\rCamadas (formato que as informações serão apresentadas, transformações estatísticas e ajustes de posicionamentos);\rEscalas para cada mapeamento estético (guias para ler os valores, normalmente explicados nas legendas);\rSistema de coordenadas; e\rEspecificação de facetas ou subconjuntos.\r\rOs três primeiros elementos são normalmente suficientes para análises exploratórias dos dados, em que o objetivo é conhecer melhor os dados que foram coletados. Tratam-se de gráficos usados apenas pelo pesquisador e, em geral, são insuficientes para apresentação dos resultados.\nPara fins desta nota, utilizaremos em quase todos os gráficos as informações relativas à taxa de desocupação da força de trabalho (Tabela 6397), ao rendimento médio real (Tabela 5437) e à média de horas habitualmente trabalhadas por semana (Tabela 6372) por grupos de idade entre o 1o trimestre de 2016 e o 1o trimestre de 2020. Todas as informações foram coletadas na Pesquisa Nacional por Amostra de Domicílios Contínua Trimestral (PNADC/T), realizada pelo IBGE. Os dados são baixados por meio do pacote sidrar. Nesse caso, baixaremos as tabelas individualmente e, ao final, juntaremos pelas categorias em comum. As informações para identificar os elementos das tabelas que queremos podem ser acessadas pela função info_sidra().\n## Tabela 6397 - Taxas de desocupação e de subutilização da força de trabalho,\r## na semana de referência, das pessoas de 14 anos ou mais de idade,\r## por grupos de idade\r# info_sidra(6397,wb = T)\rdesocupacao \u0026lt;- get_sidra(6397,\rperiod = \u0026quot;201601-202001\u0026quot;, # Seleciona trimestres\rgeo = \u0026quot;Region\u0026quot;, # 5 Regiões Brasileiras\rvariable = c(4099), format = 2)\rtabela1 \u0026lt;- desocupacao %\u0026gt;% rename(\u0026quot;Desocupacao\u0026quot; = Valor) %\u0026gt;% # Renomeia a variável de interesse\rselect(`Grande Região`,Trimestre, `Grupo de idade`,Desocupacao) head(tabela1, n = 3) # Mostra as três primeiras linhas\r## Grande Região Trimestre Grupo de idade Desocupacao\r## 2 Norte 1º trimestre 2016 Total 10.5\r## 3 Norte 1º trimestre 2016 14 a 17 anos 24.4\r## 4 Norte 1º trimestre 2016 18 a 24 anos 23.2\r## Tabela 5437 - Rendimento médio real, habitualmente recebido por mês e\r## efetivamente recebido no mês de referência, do trabalho principal e\r## de todos os trabalhos, por grupos de idade # info_sidra(5437,wb = T)\rrendimento \u0026lt;- get_sidra(5437,\rperiod = \u0026quot;201601-202001\u0026quot;,\rgeo = \u0026quot;Region\u0026quot;,\rvariable = c(5932),\rformat = 2)\rtabela2 \u0026lt;- rendimento %\u0026gt;% rename(\u0026quot;Rendimento\u0026quot; = Valor) %\u0026gt;% select(`Grande Região`,Trimestre, `Grupo de idade`,Rendimento)\rhead(tabela2, n = 3)\r## Grande Região Trimestre Grupo de idade Rendimento\r## 2 Norte 1º trimestre 2016 Total 1719\r## 3 Norte 1º trimestre 2016 14 a 17 anos 511\r## 4 Norte 1º trimestre 2016 18 a 24 anos 1077\r## Tabela 6372 - Média de horas habitualmente trabalhadas por semana e\r## efetivamente trabalhadas na semana de referência, no trabalho principal\r## e em todos os trabalhos, das pessoas de 14 anos ou mais de idade,\r## por grupos de idade\r#info_sidra(6372,wb = T)\rhoras \u0026lt;- get_sidra(6372,\rperiod = \u0026quot;201601-202001\u0026quot;,\rgeo = c(\u0026quot;Region\u0026quot;),\rvariable = c(8186),\rformat = 2)\rtabela3 \u0026lt;- horas %\u0026gt;% rename(\u0026quot;Horas\u0026quot; = Valor) %\u0026gt;% select(`Grande Região`,Trimestre, `Grupo de idade`,Horas)\rhead(tabela3, n = 3)\r## Grande Região Trimestre Grupo de idade Horas\r## 2 Norte 1º trimestre 2016 Total 37.6\r## 3 Norte 1º trimestre 2016 14 a 17 anos 25.9\r## 4 Norte 1º trimestre 2016 18 a 24 anos 37.0\r## Tabela com todos os dados agrupados por `Grande Região`,\r## `Trimestre` e `Grupo de Idade`\remprego \u0026lt;- tabela1 %\u0026gt;% left_join(tabela2) %\u0026gt;% left_join(tabela3)\rhead(emprego, n = 2)\r## Grande Região Trimestre Grupo de idade Desocupacao Rendimento Horas\r## 1 Norte 1º trimestre 2016 Total 10.5 1719 37.6\r## 2 Norte 1º trimestre 2016 14 a 17 anos 24.4 511 25.9\rPortanto, trabalharemos com a tabela chamada ``emprego’’. Um gráfico simples que relaciona horas trabalhadas e rendimento é:\nggplot(emprego,\raes(x = Horas, y = Rendimento)) +\rgeom_point()\rNote que o sinal de + é usado para adicionar camadas ao gráfico como padrão do pacote. Uma elaboração mais completa dos gráficos envolve, normalmente, os seis componentes básicos e serão detalhados abaixo.\nMapeamentos estéticos (variáveis)\rPode-se adicionar variáveis ao gráfico com a atribuição de cores (colour) e formato (shape) para variáveis categóricas e tamanho (size) para variáveis contínuas, que serão acompanhados de legenda:\nggplot(emprego,\raes(x = Horas, y = Rendimento, shape = `Grupo de idade`)) +\rgeom_point()\rRobbins, Naomi B. 2004. Creating More Effective Graphs. New Jersey - USA: Wiley-Interscience. http://library1.nida.ac.th/termpaper6/sd/2554/19755.pdf.\r\rWickham, Hadley. 2014. “Tidy Data.” Journal of Statistical Software 59 (10): 1–23. http://www.jstatsoft.org/.\r\r———. 2015. Elegant Graphics for Data Analysis. http://had.co.nz/ggplot2/book.\r\r\r\r\r\rAinda que nem todos sejam utilizados nesta nota, sugereimos ao leitor a consulta de informações adicionais dos pacotes para conhecer melhor suas respectivas funcionalidades.↩︎\n\r\r\r","date":1618876800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618918646,"objectID":"5bb79a02a5ac00da58edea7124f85324","permalink":"/project/nota/","publishdate":"2021-04-20T00:00:00Z","relpermalink":"/project/nota/","section":"project","summary":"Introdução\rApresentar informações estatísticas por meio de gráficos pode ser uma ferramenta importante para melhorar o entendimento de informações complexas. Para isso, deve-se elaborar um gráfico eficiente. Uma forma é mais eficiente que a outra se sua informação pode ser decodificada pela maioria dos leitores de forma mais rápida ou mais fácil de acordo com Robbins (2004).","tags":[],"title":"Nota sobre gráficos 3","type":"project"},{"authors":[],"categories":[],"content":"\r\r\rSistema de equações lineares\rReferências\r\r\rSistema de equações lineares\rUm dos pacotes para a solução de sistemas de equações lineares é o matlib, que é bastante útil para o estudo de Álgebra Linear e estatísticas multivariadas. O pacote precisa ser instalado antes do primeiro uso. Após, basta carregar com a função library()1.\n# install.packages(\u0026quot;matlib\u0026quot;)\rlibrary(matlib)\rO objetivo desta nota é apresentar, por meio de exemplos baseados no livro de Boldrini et al. (1980), algumas das funcionalidades do pacote. Um possível sistema com duas equações é dado por:\nA \u0026lt;- matrix(c(2,-7,1,4,−1,-10,-5,16), nrow= 4, ncol = 2)\rb \u0026lt;- matrix(c(3,-12,1,8),ncol = 1)\rshowEqn(A,b) # Mostra a estrutura do sistema de equações\r## 2*x1 - 1*x2 = 3 ## -7*x1 - 10*x2 = -12 ## 1*x1 - 5*x2 = 1 ## 4*x1 + 16*x2 = 8\rplotEqn(A,b) # Desenha as retas num gráfico com duas variáveis\r## 2*x[1] - 1*x[2] = 3 ## -7*x[1] - 10*x[2] = -12 ## x[1] - 5*x[2] = 1 ## 4*x[1] + 16*x[2] = 8\r\rFigure 1: Elaboração própria.\r\rA partir da Figura 1, pode-se perceber que há duas equações que são combinações lineares das demais.\nTambém é possível elaborar um sistema com três variáveis, resolver e fazer sua representação gráfica2:\nA \u0026lt;- matrix(c(1,2,1,4,5,-3,3,4,-2), ncol = 3)\rb \u0026lt;- c(1,4,5)\rshowEqn(A,b) # Mostra a estrutura do sistema de equações\r## 1*x1 + 4*x2 + 3*x3 = 1 ## 2*x1 + 5*x2 + 4*x3 = 4 ## 1*x1 - 3*x2 - 2*x3 = 5\rampliada \u0026lt;- cbind(A,b) # Matriz ampliada do sistema\rechelon(ampliada,verbose = T,fractions = T) # Resolve por eliminação gaussiana\r## ## Initial matrix:\r## b ## [1,] 1 4 3 1\r## [2,] 2 5 4 4\r## [3,] 1 -3 -2 5\r## ## row: 1 ## ## exchange rows 1 and 2 ## b ## [1,] 2 5 4 4\r## [2,] 1 4 3 1\r## [3,] 1 -3 -2 5\r## ## multiply row 1 by 1/2 ## b ## [1,] 1 5/2 2 2\r## [2,] 1 4 3 1\r## [3,] 1 -3 -2 5\r## ## subtract row 1 from row 2 ## b ## [1,] 1 5/2 2 2\r## [2,] 0 3/2 1 -1\r## [3,] 1 -3 -2 5\r## ## subtract row 1 from row 3 ## b ## [1,] 1 5/2 2 2\r## [2,] 0 3/2 1 -1\r## [3,] 0 -11/2 -4 3\r## ## row: 2 ## ## exchange rows 2 and 3 ## b ## [1,] 1 5/2 2 2\r## [2,] 0 -11/2 -4 3\r## [3,] 0 3/2 1 -1\r## ## multiply row 2 by -2/11 ## b ## [1,] 1 5/2 2 2\r## [2,] 0 1 8/11 -6/11\r## [3,] 0 3/2 1 -1\r## ## multiply row 2 by 5/2 and subtract from row 1 ## b ## [1,] 1 0 2/11 37/11\r## [2,] 0 1 8/11 -6/11\r## [3,] 0 3/2 1 -1\r## ## multiply row 2 by 3/2 and subtract from row 3 ## b ## [1,] 1 0 2/11 37/11\r## [2,] 0 1 8/11 -6/11\r## [3,] 0 0 -1/11 -2/11\r## ## row: 3 ## ## multiply row 3 by -11 ## b ## [1,] 1 0 2/11 37/11\r## [2,] 0 1 8/11 -6/11\r## [3,] 0 0 1 2\r## ## multiply row 3 by 2/11 and subtract from row 1 ## b ## [1,] 1 0 0 3\r## [2,] 0 1 8/11 -6/11\r## [3,] 0 0 1 2\r## ## multiply row 3 by 8/11 and subtract from row 2 ## b ## [1,] 1 0 0 3\r## [2,] 0 1 0 -2\r## [3,] 0 0 1 2\rplotEqn3d(A,b) # Desenha as retas num gráfico em três dimensões numa popup\rOutra forma de resolver o sistema se dá com o comando solve, desde que o sistema seja possível e determinado:\nA \u0026lt;- matrix(c(1,2,1,4,5,-3,3,4,-2), ncol = 3)\rb \u0026lt;- c(1,4,5)\rsolve(A,b)\r## [1] 3 -2 2\rEste pequeno resumo pode ajudar na resolução de sistemas simples ligados à álgebra linear, auxiliando no aprendizado e na resolução de exercícios.\n\rReferências\rBoldrini, José Luiz, Sueli I. Rodrigues Costa, Vera Lúcia Figueiredo, and Henri G. Wetzler. 1980. Algebra Linear. 3a ed. São Paulo - BRA: Harper \u0026amp; Row do Bra.\r\r\r\r\rPara acessar detalhes das funções do pacote, basta digitar ?nome da função. Na aba ajuda, aparecerão informações da função e, normalmente, algumas aplicações↩︎\n\rA representação gráfica é mostrada apenas em pop-up quando o código é rodado no R. O leitor pode copiar os códigos desta nota e rodar em sua própria máquina para verivicar o resultado.↩︎\n\r\r\r","date":1618876800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1619004316,"objectID":"57e6edc7405d143cecfc820548529ab9","permalink":"/r-projetos/alinear-basica/","publishdate":"2021-04-20T00:00:00Z","relpermalink":"/r-projetos/alinear-basica/","section":"r-projetos","summary":"Sistema de equações lineares\rReferências\r\r\rSistema de equações lineares\rUm dos pacotes para a solução de sistemas de equações lineares é o matlib, que é bastante útil para o estudo de Álgebra Linear e estatísticas multivariadas.","tags":["R"],"title":"Resoluções de equações lineares e eliminação gaussiana","type":"r-projetos"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Wowchemy Wowchemy | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/media/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}   Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Wowchemy's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":["Rafael de Acypreste"],"categories":null,"content":"","date":1501545600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1501545600,"objectID":"b10c7f27c2d9a89bc87960a62de9673c","permalink":"/publication/direito-moradia-livro-2017/","publishdate":"2017-08-01T00:00:00Z","relpermalink":"/publication/direito-moradia-livro-2017/","section":"publication","summary":"A obra que ora se apresenta é resultado da dissertação de mestrado do autor e revela surpreendente maturidade acadêmica. A teoria fundamentada nos dados, pouco utilizada nas pesquisas em direito, possibilitou que o autor desenvolvesse uma investigação segura, que demonstrou como o Poder Judiciário, nos conflitos nos quais o MTST está na luta por moradia, afasta os princípios constitucionais da função social da propriedade; do direito à cidade; do direito à moradia; da dignidade da pessoa humana, dentre outros, para prevalecer o título de propriedade, ainda que sem a legitimidade da posse. Fazer pesquisa qualitativa nas decisões do Poder Judiciário que envolvem movimentos sociais, na luta por direitos fundamentais, é uma escolha acertada que vai levar o leitor a caminhos pouco percorridos na pesquisa jurídica. Por fim, Rafael Acypreste apresenta sua pesquisa de forma elegante, fácil de ser lida, para que seja possível compreender a relação entre o movimento social — MTST — e o Poder Judiciário. Alexandre Bernardino Costa — Universidade de Brasília","tags":null,"title":"Direito à moradia e o poder judiciário: decisões que envolvem o MTST","type":"publication"},{"authors":["Rafael de Acypreste","Alexandre Bernardino Costa"],"categories":null,"content":"","date":1474329600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1474329600,"objectID":"38e08f4edfde3b101087ebecddc47bc0","permalink":"/publication/revista-direito-cidade-2016/","publishdate":"2016-09-20T00:00:00Z","relpermalink":"/publication/revista-direito-cidade-2016/","section":"publication","summary":"Nas ações de reintegração de posse contra o Movimento dos Trabalhadores Sem Teto (MTST), a propriedade é o elemento central de proteção do Poder Judiciário. O objetivo do trabalho é analisar a forma como o Poder Judiciário lida com conflitos fundiários urbanos dos quais faz parte o referido Movimento Social. A partir da teoria fundamentada nos dados, analisa-se todas as ações de reintegração de posse contra o MTST de 2001 a 2014. Essa metodologia permite identificar propriedades, dimensões, minúcias e singularidades das decisões com base em comparações sistemáticas entre os dados. A literatura jurídica levantada e o referencial teórico têm por base a identificação da categoria chave explicativa do conjunto dos dados. Como resultado, percebeu-se que a proteção da propriedade absoluta é o fundamento principal dos magistrados nas ações de reintegração de posse. As categorias constitucionais do direito à moradia e da função social da propriedade são pouco exploradas pelos juízes. Há, também, inconsistências processuais nas decisões e baixa preocupação com a fundamentação fática e jurídica da posse exercida pelos proprietários. Conclui-se que o Poder Judiciário, em relação ao objeto de análise, desconsidera o interesse social subjacente aos processos, para proteger a propriedade em seu formato liberal e absoluto.","tags":null,"title":"Ações de reintegração de posse contra o movimento dos trabalhadores sem teto: dicotomia entre propriedade e direito à moradia","type":"publication"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"f26b5133c34eec1aa0a09390a36c2ade","permalink":"/admin/config.yml","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/admin/config.yml","section":"","summary":"","tags":null,"title":"","type":"wowchemycms"}]